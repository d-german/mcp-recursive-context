# XPersona: Evaluating Multilingual Personalized Chatbot

**Paper ID:** 2003.07568

## Abstract

Personalized dialogue systems are an essential step toward better human-machine interaction. Existing personalized dialogue agents rely on properly designed conversational datasets, which are mostly monolingual (e.g., English), which greatly limits the usage of conversational agents in other languages. In this paper, we propose a multi-lingual extension of Persona-Chat, namely XPersona. Our dataset includes persona conversations in six different languages other than English for building and evaluating multilingual personalized agents. We experiment with both multilingual and cross-lingual trained baselines, and evaluate them against monolingual and translation-pipeline models using both automatic and human evaluation. Experimental results show that the multilingual trained models outperform the translation-pipeline and that they are on par with the monolingual models, with the advantage of having a single model across multiple languages. On the other hand, the state-of-the-art cross-lingual trained models achieve inferior performance to the other models, showing that cross-lingual conversation modeling is a challenging task. We hope that our dataset and baselines will accelerate research in multilingual dialogue systems.

## Introduction

Personalized dialogue agents have been shown efficient in conducting human-like conversation. This progress has been catalyzed thanks to existing conversational dataset such as Persona-chat BIBREF0, BIBREF1. However, the training data are provided in a single language (e.g., English), and thus the resulting systems can perform conversations only in the training language. For wide, commercial dialogue systems are required to handle a large number of languages since the smart home devices market is increasingly international BIBREF2. Therefore, creating multilingual conversational benchmarks is essential, yet challenging since it is costly to perform human annotation of data in all languages.

A possible solution is to use translation systems before and after the model inference, a two-step translation from any language to English and from English to any language. This comes with three major problems: 1) amplification of translation errors since the current dialogue systems are far from perfect, especially with noisy input; 2) the three-stage pipeline system is significantly slower in terms of inference speed; and 3) high translation costs since the current state-of-the-art models, especially in low resources languages, are only available using costly APIs.

In this paper, we analyze two possible workarounds to alleviate the aforementioned challenges. The first is to build a cross-lingual transferable system by aligning cross-lingual representations, as in BIBREF3, in which the system is trained on one language and zero-shot to another language. The second is to learn a multilingual system directly from noisy multilingual data (e.g., translated data), thus getting rid of the translation system dependence at inference time.

To evaluate the aforementioned systems, we propose a dataset called Multilingual Persona-Chat, or XPersona, by extending the Persona-Chat corpora BIBREF1 to six languages: Chinese, French, Indonesian, Italian, Korean, and Japanese. In XPersona, the training sets are automatically translated using translation APIs with several human-in-the-loop passes of mistake correction. In contrast, the validation and test sets are annotated by human experts to facilitate both automatic and human evaluations in multiple languages.

Furthermore, we propose competitive baselines in two training settings, namely, cross-lingual and multilingual, and compare them with translation pipeline models. Our baselines leverage pre-trained cross-lingual BIBREF4 and multilingual BIBREF5 models.

An extensive automatic and human evaluation BIBREF6 of our models shows that a multilingual system is able to outperform strong translation-based models and on par with or even improve the monolingual model. The cross-lingual performance is still lower than other models, which indicates that cross-lingual conversation modeling is very challenging. The main contribution of this paper are summarized as follows:

We present the first multilingual non-goal-oriented dialogue benchmark for evaluating multilingual generative chatbots.

We provide both cross-lingual and multilingual baselines and discuss their limitations to inspire future research.

We show the potential of multilingual systems to understand the mixed language dialogue context and generate coherent responses.

## Related Work ::: Dialogue Systems

are categorized as goal-oriented BIBREF7, BIBREF8 and chit-chat BIBREF9, BIBREF10. Interested readers may refer to BIBREF11 for a general overview. In this paper, we focus on the latter, for which, in recent years, several tasks and datasets have been proposed to ground the conversation on knowledge BIBREF12, BIBREF13, BIBREF14, BIBREF15, BIBREF16, BIBREF17, BIBREF18 such as Wiki-Articles, Reddit-Post, and CNN-Article. In this work, we focus on personalized dialogue agents where the dialogues are grounded on persona information.

BIBREF19 was the first to introduce a persona-grounded dialogue dataset for improving response consistency. Later on, BIBREF0 and BIBREF1 introduced Persona-chat, a multi-turn conversational dataset, where two speakers are paired, and a persona description (4–5 sentences) is randomly assigned to each of them. By conditioning the response generation on the persona descriptions, a chit-chat model is able to produce a more persona-consistent dialogue BIBREF0. Several works have improved on the initial baselines with various methodologies BIBREF20, BIBREF21, BIBREF22, BIBREF23, BIBREF24, BIBREF25, especially using large pre-trained models BIBREF26, BIBREF27.

## Related Work ::: Multilingual

Extensive approaches have been introduced to construct multilingual systems, for example, multilingual semantic role labeling BIBREF28, BIBREF29, multilingual machine translation BIBREF30, multilingual automatic speech recognition BIBREF31, BIBREF32, BIBREF33, BIBREF34, and named entity recognition BIBREF35, BIBREF36. Multilingual deep contextualized model such as Multilingual BERT (M-BERT) BIBREF5 have been commonly used to represent multiple languages and elevate the performance in many NLP applications, such as classification tasks BIBREF37, textual entailment, named entity recognition BIBREF38, and natural language understanding BIBREF39. Multilingual datasets have also been created for a number of NLP tasks, such as named entity recognition or linking BIBREF40, BIBREF41, BIBREF42, BIBREF43, question answering BIBREF44, BIBREF45, semantic role labeling BIBREF46, part-of-speech tagging BIBREF47, dialogue state tracking BIBREF48, and natural language understanding BIBREF49. However, none of these datasets include the multilingual chit-chat task.

## Related Work ::: Cross-lingual

Cross-lingual adaptation learns the inter-connections among languages and circumvents the requirement of extensive training data in target languages BIBREF50, BIBREF51, BIBREF52. Cross-lingual transfer learning methods have been applied to multiple NLP tasks, such as named entity recognition BIBREF53, BIBREF54, natural language understanding BIBREF39, dialogue state tracking BIBREF55, part-of-speech tagging BIBREF50, BIBREF51, BIBREF56, and dependency parsing BIBREF57, BIBREF58. Meanwhile, BIBREF59 and BIBREF60 proposed pre-trained cross-lingual language models to align multiple language representations, achieving state-of-the-art results in many cross-lingual classification tasks. The aforementioned tasks focused on classification and sequence labeling, while instead, BIBREF4 proposed to pre-train both the encoder and decoder of a sequence-to-sequence model (XNLG) to conduct cross-lingual generation tasks, namely, question generation and abstractive summarization. The latter is the closest to our task since it focuses on language generation; however cross-lingual dialogue generation has not yet been explored.

## Data Collection

The proposed XPersona dataset is an extension of the persona-chat dataset BIBREF0, BIBREF1. Specifically, we extend the ConvAI2 BIBREF1 to six languages: Chinese, French, Indonesian, Italian, Korean, and Japanese. Since the test set of ConvAI2 is hidden, we split the original validation set into a new validation set and test sets. Then, we firstly automatically translate the training, validation, and test set using APIs (PapaGo for Korean, Google Translate for other languages). For each language, we hired native speaker annotators with a fluent level of English and asked them to revise the machine-translated dialogues and persona sentences in the validation set and test set according to original English dialogues. The main goal of human annotation is to ensure the resulting conversations are coherent and fluent despite the cultural differences in target languages. Therefore, annotators are not restricted to only translate the English dialogues, and they are allowed to modify the original dialogues to improve the dialogue coherence in the corresponding language while retaining the persona information. The full annotation instructions are reported in Appendix A.

Compared to collecting new persona sentences and dialogues in each language, human-annotating the dialogues by leveraging translation APIs has multiple advantages. First, it increases the data distribution similarity across languages BIBREF3, which can better examine the system's cross-lingual transferability. Second, revising the machine-translated dialogues based on the original English dialogue improves the data construction efficiency. Third, it leverages the well-constructed English persona conversations as a reference to ensure the dialogue quality without the need for training a new pool of workers to generate new samples BIBREF3.

On the other hand, human-translating the entire training-set ($\sim $130K utterances) in six languages is expensive. Therefore, we propose an iterative method to improve the quality of the automatically translated training set. We firstly sample 200 dialogues from the training set ($\sim $2600 utterances) in each language, and we assign human annotators to list all frequent translation mistakes in the given dialogues. For example, daily colloquial English expressions such as “cool", “I see", and “lol" are usually literally translated. After that, we use a simple string matching to revise the inappropriate translations in the whole training-set and return a revision log, which records all the revised utterances. Then, we assign human annotators to check all the revised utterances and list translation mistakes again. We repeat this process at least twice for each language. Finally, we summarize the statistics of the collected dataset in Table TABREF6.

## Multilingual Personalized Conversational Models

Let us define a dialogue $\mathcal {D}=\lbrace U_1,S_1,U_2,S_2, \dots , U_n, S_n\rbrace $ as an alternating set of utterances from two speakers, where $U$ and $S$ represent the user and the system, respectively. Each speaker has its corresponding persona description that consists of a set of sentences $\mathcal {P}=\lbrace P_1,\dots ,P_m\rbrace $. Given the system persona sentences $\mathcal {P}_s$ and dialogue history $\mathcal {D}_t=\lbrace U_1,S_1,U_2, \dots ,S_{t-1}, U_t\rbrace $, we are interested in predicting the system utterances $S_t$.

## Multilingual Personalized Conversational Models ::: Model Architecture

We explore both encoder-decoder and causal decoder architectures, and we leverage existing pre-trained contextualized multilingual language models as weights initialization. Hence, we firstly define the multilingual embedding layer and then the two multilingual models used in our experiments.

## Multilingual Personalized Conversational Models ::: Model Architecture ::: Embedding

We define three embedding matrices: word embedding $E^W\in \mathbb {R}^{|V| \times d}$, positional embedding $E^P\in \mathbb {R}^{M \times d}$, and segmentation embedding $E^S\in \mathbb {R}^{|S| \times d}$, where $|.|$ denotes set cardinality, $d$ is the embedding size, $V$ denotes the vocabulary, $M$ denotes the maximum sequence length, and $S$ denotes the set of segmentation tokens. Segmentation embedding BIBREF26 is used to indicate whether the current token is part of i) Persona sentences, ii) System (Sys.) utterances, iii) User utterances, iv) response in Language $l_{id}$. The language embedding $l_{id}$ is used to inform the model which language to generate. Hence, given a sequence of tokens $X$, the embedding functions $E$ are defined as:

where $\oplus $ denotes the positional sum, $X_{pos}=\lbrace 1,\dots ,|X|\rbrace $ and $X_{seg}$ is the sequence of segmentation tokens, as in BIBREF26. Figure FIGREF9 shows a visual representation of the embedding process. A more detailed illustration is reported in Appendix B.

## Multilingual Personalized Conversational Models ::: Model Architecture ::: Encoder-Decoder

To model the response generation, we use a Transformer BIBREF61 based encoder-decoder BIBREF10. As illustrated in Figure FIGREF9, we concatenate the system persona $\mathcal {P}_s$ with the dialogue history $\mathcal {D}_t$. Then we use the embedding layer $E$ to finally pass it to the encoder. In short, we have:

where $H \in \mathbb {R}^{L \times d_{model}}$ is the hidden representation computed by the encoder, and $L$ denotes the input sequence length. Then, the decoder attends to $H$ and generates the system response $S_t$ token by token. In the decoder, segmentation embedding is the language ID embedding (e.g., we look up the embedding for Italian to decode Italian). Thus:

## Multilingual Personalized Conversational Models ::: Model Architecture ::: Causal Decoder

As an alternative to encoder-decoders, the causal-decoders BIBREF62, BIBREF63, BIBREF64 have been used to model conversational responses BIBREF26, BIBREF27 by giving as a prefix the dialogue history. In our model, we concatenate the persona $\mathcal {P}_s$ and the dialogue history $\mathcal {D}_t$ as the language model prefix, and autoregressively decode the system response $S_t$ based on language embedding (i.e. $l_{id}$):

Figure FIGREF9 shows the conceptual differences between the encoder-decoder and casual decoder. Note that in both multilingual models, the dialogue history encoding process is language-agnostic, while decoding language is controlled by the language embedding. Such design allows the model to understand mixed-language dialogue contexts and to responds in the desired language (details in Section SECREF44).

## Multilingual Personalized Conversational Models ::: Training Strategy

We consider two training strategies to learn a multilingual conversational model: multilingual training and cross-lingual training.

## Multilingual Personalized Conversational Models ::: Training Strategy ::: Multilingual Training

jointly learns to perform personalized conversations in multiple languages. We follow a transfer learning approach BIBREF26, BIBREF65 by initializing our models with the weights of the large multilingual pretrained model M-Bert BIBREF37. For the causal decoder, we add the causal mask into self-attention layer to convert M-Bert encoder to decoder. For encoder-decoder model, we randomly initialize the cross encoder-decoder attention BIBREF66. Then, we train the both models on the combined training set in all 7 languages using cross-entropy loss.

## Multilingual Personalized Conversational Models ::: Training Strategy ::: Cross-lingual Training

transfers knowledge from the source language data to the target languages. In this setting, the model is trained on English (source language) conversational samples, and evaluated on the other 6 languages. Following the methodology proposed by BIBREF4, we align the embedded representations of different languages into the same embedding space by applying cross-lingual pre-training to the encoder-decoder model. The pre-training procedure consists of two stages:

pre-training the encoder and the decoder independently utilizing masked language modeling, as in BIBREF59;

jointly pre-training the encoder-decoder by using two objective functions: Cross-Lingual Auto-Encoding (XAE) and Denoising Auto-Encoding (DAE) BIBREF4.

For instance, DAE adds perturbations to the input sentence and tries to reconstructs the original sentence using the decoder, whereas, XAE uses parallel translation data as the supervision signal to pre-train both the encoder and decoder. As in the multilingual models, the language IDs are fed into the decoder to control the language of generated sentences. Both pre-training stages require both parallel and non-parallel data in the target language.

After the two stages of pre-training, the model is fine-tuned using just the source language samples (i.e., English) with the same cross-entropy loss as for the multilingual training. However, as suggested in BIBREF4, only the encoder parameters are updated with back-propagation and both the decoder and the word embedding layer remain frozen. This retains the decoders' ability to generate multilingual output while still being able to learn new tasks using only the target language.

## Experiments ::: Evaluation Metrics

Evaluating open-domain chit-chat models is challenging, especially in multiple languages and at the dialogue-level. Hence, we evaluate our models using both automatic and human evaluation. In both cases, human-annotated dialogues are used, which show the importance of the provided dataset.

## Experiments ::: Evaluation Metrics ::: Automatic

For each language, we evaluate responses generated by the models using perplexity (ppl.) and BLEU BIBREF67 with reference to the human-annotated responses. Although these automatic measures are not perfect BIBREF68, they help to roughly estimate the performance of different models under the same test set. More recently, BIBREF69 has shown the correlation between perplexity and human judgment in open-domain chit-chat models.

## Experiments ::: Evaluation Metrics ::: Human

Asking humans to evaluate the quality of a dialogue model is challenging, especially when multiple models have to be compared. The likert score (a.k.a. 1 to 5 scoring) has been widely used to evaluate the interactive experience with conversational models BIBREF70, BIBREF65, BIBREF0, BIBREF1. In such evaluation, a human interacts with the systems for several turns, and then they assign a score from 1 to 5 based on three questions BIBREF0 about fluency, engagingness, and consistency. This evaluation is both expensive to conduct and requires many samples to achieve statistically significant results BIBREF6. To cope with these issues, BIBREF6 proposed ACUTE-EVAL, an A/B test evaluation for dialogue systems. The authors proposed two modes: human-model chats and self-chat BIBREF71, BIBREF72. In this work, we opt for the latter since it is cheaper to conduct and achieves similar results BIBREF6 to the former. Another advantage of using this method is the ability to evaluate multi-turn conversations instead of single-turn responses.

Following ACUTE-EVAL, the annotator is provided with two full dialogues made by self-chat or human-dialogue. The annotator is asked to choose which of the two dialogues is better in terms of engagingness, interestingness, and humanness. For each comparison, we sample 60–100 conversations from both models. In Appendix C, we report the exact questions and instructions given to the annotators, and the user interface used in the evaluation. We hired native speakers annotators for all six considered languages. The annotators were different from the dataset collection annotators to avoid any possible bias.

## Experiments ::: Implementation Details ::: Multilingual Models

We use the "BERT-Base, Multilingual Cased" checkpoint, and we denote the multilingual encoder-decoder model as M-Bert2Bert ($\sim $220M parameters) and causal decoder model as M-CausalBert ($\sim $110M parameters). We fine-tune both models in the combined training set (English in Persona-chat BIBREF0, six languages in Xpersona) for five epochs with AdamW optimizer and a learning rate of $6.25e$-5.

## Experiments ::: Implementation Details ::: Monolingual Models

To verify whether the multilingual agent will under-perform the monolingual agent in the monolingual conversational task, we build a monolingual encoder-decoder model and causal decoder model for each language. For a fair comparison, we initialize the monolingual models with a pre-trained monolingual BERT BIBREF5, BIBREF73, BIBREF74. We denote the monolingual encoder-decoder model as Bert2Bert ($\sim $220M parameters) and causal decoder model as CausalBert ($\sim $110M parameters). Then we fine-tune each model in each language independently for the same number of epoch and optimizer as the multilingual model.

## Experiments ::: Implementation Details ::: Translation-based Models

Another strong baseline we compare with is Poly-encoder BIBREF75, a large-scale pre-trained retrieval model that has shown state-of-the-art performance in the English Persona-chat dataset BIBREF6. We adapt this model to the other languages by using the Google Translate API to translate target languages (e.g., Chinese) query to English as the input to the model, then translate the English response back to the target language. Thus, the response generation flow is: target query $\rightarrow $ English query $\rightarrow $ English response $\rightarrow $ target response. We denote this model as Poly.

## Experiments ::: Implementation Details ::: Cross-lingual Models.

In the first pre-training stage, we use the pre-trained weights from XLMR-base BIBREF60. Then, we follow the second pre-training stage of XNLG BIBREF4 for pre-training Italian, Japanese, Korean, Indonesia cross-lingual transferable models. For Chinese and French, we directly apply the pre-trained XNLG BIBREF4 weights. Then, the pre-trained models are fine-tune on English PersonaChat training set and early stop based on the perplexity on target language validation set.

## Experiments ::: Results and Discussion ::: Quantitative Analysis

Table TABREF20 compares monolingual, multilingual, and cross-lingual models in terms of BLEU and perplexity in the human-translated test set. On both evaluation matrices, the causal decoder models outperform the encoder-decoder models. We observe that the encoder-decoder model tends to overlook dialogue context and generate digressive responses. (Generated samples are available in Appendix D) We hypothesize that this is because the one-to-many problem BIBREF76 in open-domain conversation weakens the relation between encoder and decoder; thus the well pre-trained decoder (Bert) easily converges to a locally-optimal, and learns to ignore the dialogue context from the encoder and generate the response in an unconditional language model way. We leave the investigation of this problem to future work. On the other hand, M-CausalBert achieves a comparable or slightly better performance compared to CausalBert, which suggests that M-CausalBert leverages the data from other languages. As expected, we observe a significant gap between the cross-lingual model and other models, which indicates that cross-lingual zero-shot conversation modeling is very challenging.

Table TABREF28 shows the human evaluation result of comparing M-CausalBert (Multi) against the human, translation-based Poly-encoder (Poly), and monolingual CausalBert (Mono). The results illustrate that Multi outperforms Mono in English and Chinese, and is on par with Mono in other languages. On the other hand, Poly shows a strong performance in English as it was pre-trained with a large-scale English conversation corpus. In contrast, the performance of Poly drops in other languages, which indicates that the imperfect translation affects translation-based systems.

## Experiments ::: Results and Discussion ::: Qualitative Analysis and Discussion

We randomly sample 7 self-chat dialogues for each baseline model in the seven languages and report them in Appendix D., And we summarize the generation of each model as follows:

## Experiments ::: Results and Discussion ::: Qualitative Analysis and Discussion ::: Poly

Poly-encoder, pretrained on 174 million Reddit data, can accurately retrieve coherent and diverse responses in English. However, in the other six languages, some of the retrieved responses are digressive due to translation error.

## Experiments ::: Results and Discussion ::: Qualitative Analysis and Discussion ::: Monolingual & Multilingual

We observe that both the monolingual and multilingual models can generate fluent responses. Compared to Bert2Bert and M-Bert2Bert, CausalBert and M-CausalBert can generate more on-topic responses but sometimes repeat through turns. CausalBert and M-CausalBert are on par with each other in monolingual conversational tasks, while M-CausalBert shows the advantage of handling a mixed-language context. For multilingual speakers, the conversation may involve multiple languages. Therefore, we experiment on M-CausalBert with two settings: 1) many-to-one, in which users converse with the model in 6 languages, and the model generate responses in English, 2) one-to-many, in which users converse with the model using English, and the model generates responses in 6 languages using language embedding and corresponding persona sentences. Table TABREF42 and table TABREF43 illustrate the generation examples under these settings (more examples reported in Appendix C.1). Most of the time, M-CausalBert can understand the mixed-language context, and decode coherent response in different languages. Understanding the mixed-language dialogue context is a desirable skill for end-to-end chit-chat systems, and a systematic study of this research question is needed in future.

## Experiments ::: Results and Discussion ::: Qualitative Analysis and Discussion ::: Cross-lingual.

The current state-of-the-art cross-lingual generation approach XNLG BIBREF4 shows inferior performance on multi-turn dialogue tasks, and generates repetitive responses. Although cross-lingual dialogue generation is challenging, it reduces the human effort for data annotation in different languages. Therefore, the cross-language transfer is an important direction to investigate.

## Conclusion

In this paper, we studied both cross-lingual and multilingual approaches in end-to-end personalized dialogue modeling. We presented the XPersona dataset, a multilingual extension of Persona-Chat, for evaluating the multilingual personalized chatbots. We further provided both cross-lingual and multilingual baselines and compared them with the monolingual approach and two-stage translation approach. Extensive automatic evaluation and human evaluation were conducted to examine the models' performance. The experimental results showed that multilingual trained models, with a single model across multiple languages, can outperform the two-stage translation approach and is on par with monolingual models. On the other hand, the current state-of-the-art cross-lingual approach XNLG achieved lower performance than other baselines. In future work, we plan to research a more advanced cross-lingual generation approach and construct a mixed-language conversational benchmark for evaluating multilingual systems.

## Dataset Collection ::: Annotation Instructions

In this section, we show the instructions for French annotation:

There are two existing columns of conversations: the first column (en) is the original conversations in English, the second column (fr) is the conversations translated by an automatic system (e.g., Google Translate).

You should copy the conversation from the second column (the translated conversations) into the third column (named fr_annotation). In that column, you should then revise the incorrect or inappropriate translations.

The goal of the revision is to make the conversations more coherent and fluent in the target language (French). Hence you can customize dialogues and persona sentences to make them fluent and coherent in the target language, including by deviating from the original translation. However, you should retain persona and conversation consistency.

## Dataset Collection ::: Training Set Statistics

We report our iterative revised training set statistics in Table TABREF53.

## Model Detail

Figure FIGREF55 and FIGREF56 illustrates the details of the multilingual causal decoder and the multilingual encoder-decoder models.

## Human Evaluation

As illustrated in Figure FIGREF54, the annotator is provided with two full dialogues made by a self-chat model or human-dialogues. Then the annotators are asked the following questions:

Who would you talk to for a long conversation?

If you had to say one of these speakers is interesting and one is boring, who would you say is more interesting?

Which speaker sounds more human?

## Generated Samples ::: Mixed-language Samples

We report more the mixed-language samples generated by M-CausalBert in Table TABREF61 and TABREF62.

## Generated Samples ::: Model Comparison Samples

We randomly sample one self-chat dialogue examples for each model in each language and report them in figure 5-32.

in CausalBert,M-CausalBert,PolyEncoder,M-Bert2Bert

in CausalBert,M-CausalBert,PolyEncoder,M-Bert2Bert

in CausalBert,M-CausalBert,PolyEncoder,M-Bert2Bert

in CausalBert,M-CausalBert,PolyEncoder,M-Bert2Bert

in CausalBert,M-CausalBert,PolyEncoder,M-Bert2Bert

in CausalBert,M-CausalBert,PolyEncoder,M-Bert2Bert

in CausalBert,M-CausalBert,PolyEncoder,M-Bert2Bert
