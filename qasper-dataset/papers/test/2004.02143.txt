# Reinforced Multi-task Approach for Multi-hop Question Generation

**Paper ID:** 2004.02143

## Abstract

Question generation (QG) attempts to solve the inverse of question answering (QA) problem by generating a natural language question given a document and an answer. While sequence to sequence neural models surpass rule-based systems for QG, they are limited in their capacity to focus on more than one supporting fact. For QG, we often require multiple supporting facts to generate high-quality questions. Inspired by recent works on multi-hop reasoning in QA, we take up Multi-hop question generation, which aims at generating relevant questions based on supporting facts in the context. We employ multitask learning with the auxiliary task of answer-aware supporting fact prediction to guide the question generator. In addition, we also proposed a question-aware reward function in a Reinforcement Learning (RL) framework to maximize the utilization of the supporting facts. We demonstrate the effectiveness of our approach through experiments on the multi-hop question answering dataset, HotPotQA. Empirical evaluation shows our model to outperform the single-hop neural question generation models on both automatic evaluation metrics such as BLEU, METEOR, and ROUGE, and human evaluation metrics for quality and coverage of the generated questions.

## Introduction

In natural language processing (NLP), question generation is considered to be an important yet challenging problem. Given a passage and answer as inputs to the model, the task is to generate a semantically coherent question for the given answer.

In the past, question generation has been tackled using rule-based approaches such as question templates BIBREF0 or utilizing named entity information and predictive argument structures of sentences BIBREF1. Recently, neural-based approaches have accomplished impressive results BIBREF2, BIBREF3, BIBREF4 for the task of question generation. The availability of large-scale machine reading comprehension datasets such as SQuAD BIBREF5, NewsQA BIBREF6, MSMARCO BIBREF7 etc. have facilitated research in question answering task. SQuAD BIBREF5 dataset itself has been the de facto choice for most of the previous works in question generation. However, 90% of the questions in SQuAD can be answered from a single sentence BIBREF8, hence former QG systems trained on SQuAD are not capable of distilling and utilizing information from multiple sentences. Recently released multi-hop datasets such as QAngaroo BIBREF9, ComplexWebQuestions BIBREF10 and HotPotQA BIBREF11 are more suitable for building QG systems that required to gather and utilize information across multiple documents as opposed to a single paragraph or sentence.

In multi-hop question answering, one has to reason over multiple relevant sentences from different paragraphs to answer a given question. We refer to these relevant sentences as supporting facts in the context. Hence, we frame Multi-hop question generation as the task of generating the question conditioned on the information gathered from reasoning over all the supporting facts across multiple paragraphs/documents. Since this task requires assembling and summarizing information from multiple relevant documents in contrast to a single sentence/paragraph, therefore, it is more challenging than the existing single-hop QG task. Further, the presence of irrelevant information makes it difficult to capture the supporting facts required for question generation. The explicit information about the supporting facts in the document is not often readily available, which makes the task more complex. In this work, we provide an alternative to get the supporting facts information from the document with the help of multi-task learning. Table TABREF1 gives sample examples from SQuAD and HotPotQA dataset. It is cleared from the example that the single-hop question is formed by focusing on a single sentence/document and answer, while in multi-hop question, multiple supporting facts from different documents and answer are accumulated to form the question.

Multi-hop QG has real-world applications in several domains, such as education, chatbots, etc. The questions generated from the multi-hop approach will inspire critical thinking in students by encouraging them to reason over the relationship between multiple sentences to answer correctly. Specifically, solving these questions requires higher-order cognitive-skills (e.g., applying, analyzing). Therefore, forming challenging questions is crucial for evaluating a student’s knowledge and stimulating self-learning. Similarly, in goal-oriented chatbots, multi-hop QG is an important skill for chatbots, e.g., in initiating conversations, asking and providing detailed information to the user by considering multiple sources of information. In contrast, in a single-hop QG, only single source of information is considered while generation.

In this paper, we propose to tackle Multi-hop QG problem in two stages. In the first stage, we learn supporting facts aware encoder representation to predict the supporting facts from the documents by jointly training with question generation and subsequently enforcing the utilization of these supporting facts. The former is achieved by sharing the encoder weights with an answer-aware supporting facts prediction network, trained jointly in a multi-task learning framework. The latter objective is formulated as a question-aware supporting facts prediction reward, which is optimized alongside supervised sequence loss. Additionally, we observe that multi-task framework offers substantial improvements in the performance of question generation and also avoid the inclusion of noisy sentences information in generated question, and reinforcement learning (RL) brings the complete and complex question to otherwise maximum likelihood estimation (MLE) optimized QG model.

Our main contributions in this work are: (i). We introduce the problem of multi-hop question generation and propose a multi-task training framework to condition the shared encoder with supporting facts information. (ii). We formulate a novel reward function, multihop-enhanced reward via question-aware supporting fact predictions to enforce the maximum utilization of supporting facts to generate a question; (iii). We introduce an automatic evaluation metric to measure the coverage of supporting facts in the generated question. (iv). Empirical results show that our proposed method outperforms the current state-of-the-art single-hop QG models over several automatic and human evaluation metrics on the HotPotQA dataset.

## Related Work

Question generation literature can be broadly divided into two classes based on the features used for generating questions. The former regime consists of rule-based approaches BIBREF12, BIBREF1 that rely on human-designed features such as named-entity information, etc. to leverage the semantic information from a context for question generation. In the second category, question generation problem is treated as a sequence-to-sequence BIBREF13 learning problem, which involves automatic learning of useful features from the context by leveraging the sheer volume of training data. The first neural encoder-decoder model for question generation was proposed in BIBREF2. However, this work does not take the answer information into consideration while generating the question. Thereafter, several neural-based QG approaches BIBREF3, BIBREF14, BIBREF15 have been proposed that utilize the answer position information and copy mechanism. BIBREF16 and BIBREF17 demonstrated an appreciable improvement in the performance of the QG task when trained in a multi-task learning framework.

The model proposed by BIBREF18, BIBREF19 for single-document QA experience a significant drop in accuracy when applied in multiple documents settings. This shortcoming of single-document QA datasets is addressed by newly released multi-hop datasets BIBREF9, BIBREF10, BIBREF11 that promote multi-step inference across several documents. So far, multi-hop datasets have been predominantly used for answer generation tasks BIBREF20, BIBREF21, BIBREF22. Our work can be seen as an extension to single hop question generation where a non-trivial number of supporting facts are spread across multiple documents.

## Proposed Approach ::: Problem Statement:

In multi-hop question generation, we consider a document list $L$ with $n_L$ documents, and an $m$-word answer $A$. Let the total number of words in all the documents $D_i \in L$ combined be $N$. Let a document list $L$ contains a total of $K$ candidate sentences $CS=\lbrace S_1, S_2, \ldots , S_K\rbrace $ and a set of supporting facts $SF$ such that $SF \in CS$. The answer $A=\lbrace w_{D_k^{a_1}} , w_{D_k^{a_2}}, \ldots , w_{D_k^{a_m}} \rbrace $ is an $m$-length text span in one of the documents $D_k \in L$. Our task is to generate an $n_Q$-word question sequence $\hat{Q}= \lbrace y_1, y_2, \ldots , y_{n_Q} \rbrace $ whose answer is based on the supporting facts $SF$ in document list $L$. Our proposed model for multi-hop question generation is depicted in Figure FIGREF2.

## Proposed Approach ::: Multi-Hop Question Generation Model

In this section, we discuss the various components of our proposed Multi-Hop QG model. Our proposed model has four components (i). Document and Answer Encoder which encodes the list of documents and answer to further generate the question, (ii). Multi-task Learning to facilitate the QG model to automatically select the supporting facts to generate the question, (iii). Question Decoder, which generates questions using the pointer-generator mechanism and (iv). MultiHop-Enhanced QG component which forces the model to generate those questions which can maximize the supporting facts prediction based reward.

## Proposed Approach ::: Multi-Hop Question Generation Model ::: Document and Answer Encoder

The encoder of the Multi-Hop QG model encodes the answer and documents using the layered Bi-LSTM network.

## Proposed Approach ::: Multi-Hop Question Generation Model ::: Document and Answer Encoder ::: Answer Encoding:

We introduce an answer tagging feature that encodes the relative position information of the answer in a list of documents. The answer tagging feature is an $N$ length list of vector of dimension $d_1$, where each element has either a tag value of 0 or 1. Elements that correspond to the words in the answer text span have a tag value of 1, else the tag value is 0. We map these tags to the embedding of dimension $d_1$. We represent the answer encoding features using $\lbrace a_1, \ldots , a_N\rbrace $.

## Proposed Approach ::: Multi-Hop Question Generation Model ::: Document and Answer Encoder ::: Hierarchical Document Encoding:

To encode the document list $L$, we first concatenate all the documents $D_k \in L$, resulting in a list of $N$ words. Each word in this list is then mapped to a $d_2$ dimensional word embedding $u \in \mathbb {R}^{d_2}$. We then concatenate the document word embeddings with answer encoding features and feed it to a bi-directional LSTM encoder $\lbrace LSTM^{fwd}, LSTM^{bwd}\rbrace $.

We compute the forward hidden states $\vec{z}_{t}$ and the backward hidden states $ \scalebox {-1}[1]{\vec{\scalebox {-1}[1]{z}}}_{t}$ and concatenate them to get the final hidden state $z_{t} = [\vec{z}_{t} \oplus \scalebox {-1}[1]{\vec{\scalebox {-1}[1]{z}}}_{t}]$. The answer-aware supporting facts predictions network (will be introduced shortly) takes the encoded representation as input and predicts whether the candidate sentence is a supporting fact or not. We represent the predictions with $p_1, p_2, \ldots , p_K$. Similar to answer encoding, we map each prediction $p_i$ with a vector $v_i$ of dimension $d_3$.

A candidate sentence $S_i$ contains the $n_i$ number of words. In a given document list $L$, we have $K$ candidate sentences such that $\sum _{i=1}^{i=K} n_i = N$. We generate the supporting fact encoding $sf_i \in \mathbb {R}^{n_i \times d_3}$ for the candidate sentence $S_i$ as follows:

where $e_{n_i} \in \mathbb {R}^{n_i}$ is a vector of 1s. The rows of $sf_i$ denote the supporting fact encoding of the word present in the candidate sentence $S_i$. We denote the supporting facts encoding of a word $w_t$ in the document list $L$ with $s_t \in \mathbb {R}^{d_3}$. Since, we also deal with the answer-aware supporting facts predictions in a multi-task setting, therefore, to obtain a supporting facts induced encoder representation, we introduce another Bi-LSTM layer.

Similar to the first encoding layer, we concatenate the forward and backward hidden states to obtain the final hidden state representation.

## Proposed Approach ::: Multi-Hop Question Generation Model ::: Multi-task Learning

We introduce the task of answer-aware supporting facts prediction to condition the QG model's encoder with the supporting facts information. Multi-task learning facilitates the QG model to automatically select the supporting facts conditioned on the given answer. This is achieved by using a multi-task learning framework where the answer-aware supporting facts prediction network and Multi-hop QG share a common document encoder (Section SECREF8). The network takes the encoded representation of each candidate sentence $S_i \in CS$ as input and sentence-wise predictions for the supporting facts. More specifically, we concatenate the first and last hidden state representation of each candidate sentence from the encoder outputs and pass it through a fully-connected layer that outputs a Sigmoid probability for the sentence to be a supporting fact. The architecture of this network is illustrated in Figure FIGREF2 (left). This network is then trained with a binary cross entropy loss and the ground-truth supporting facts labels:

where $N$ is the number of document list, $S$ the number of candidate sentences in a particular training example, $\delta _i^j$ and $p_i^{j}$ represent the ground truth supporting facts label and the output Sigmoid probability, respectively.

## Proposed Approach ::: Multi-Hop Question Generation Model ::: Question Decoder

We use a LSTM network with global attention mechanism BIBREF23 to generate the question $\hat{Q} = \lbrace y_1, y_2, \ldots , y_m\rbrace $ one word at a time. We use copy mechanism BIBREF24, BIBREF25 to deal with rare or unknown words. At each timestep $t$,

The attention distribution $\alpha _t$ and context vector $c_t$ are obtained using the following equations:

The probability distribution over the question vocabulary is then computed as,

where $\mathbf {W_q}$ is a weight matrix. The probability of picking a word (generating) from the fixed vocabulary words, or the probability of not copying a word from the document list $L$ at a given timestep $t$ is computed by the following equation:

where, $\mathbf {W_a}$ and $\mathbf {W_b}$ are the weight matrices and $\sigma $ represents the Sigmoid function. The probability distribution over the words in the document is computed by summing over all the attention scores of the corresponding words:

where $\mathbf {1}\lbrace w==w_i\rbrace $ denotes the vector of length $N$ having the value 1 where $w==w_i$, otherwise 0. The final probability distribution over the dynamic vocabulary (document and question vocabulary) is calculated by the following:

## Proposed Approach ::: Multi-Hop Question Generation Model ::: MultiHop-Enhanced QG

We introduce a reinforcement learning based reward function and sequence training algorithm to train the RL network. The proposed reward function forces the model to generate those questions which can maximize the reward.

## Proposed Approach ::: Multi-Hop Question Generation Model ::: MultiHop-Enhanced QG ::: MultiHop-Enhanced Reward (MER):

Our reward function is a neural network, we call it Question-Aware Supporting Fact Prediction network. We train our neural network based reward function for the supporting fact prediction task on HotPotQA dataset. This network takes as inputs the list of documents $L$ and the generated question $\hat{Q}$, and predicts the supporting fact probability for each candidate sentence. This model subsumes the latest technical advances of question answering, including character-level models, self-attention BIBREF26, and bi-attention BIBREF18. The network architecture of the supporting facts prediction model is similar to BIBREF11, as shown in Figure FIGREF2 (right). For each candidate sentence in the document list, we concatenate the output of the self-attention layer at the first and last positions, and use a binary linear classifier to predict the probability that the current sentence is a supporting fact. This network is pre-trained on HotPotQA dataset using binary cross-entropy loss.

For each generated question, we compute the F1 score (as a reward) between the ground truth supporting facts and the predicted supporting facts. This reward is supposed to be carefully used because the QG model can cheat by greedily copying words from the supporting facts to the generated question. In this case, even though high MER is achieved, the model loses the question generation ability. To handle this situation, we regularize this reward function with additional Rouge-L reward, which avoids the process of greedily copying words from the supporting facts by ensuring the content matching between the ground truth and generated question. We also experiment with BLEU as an additional reward, but Rouge-L as a reward has shown to outperform the BLEU reward function.

## Proposed Approach ::: Multi-Hop Question Generation Model ::: MultiHop-Enhanced QG ::: Adaptive Self-critical Sequence Training:

We use the REINFORCE BIBREF27 algorithm to learn the policy defined by question generation model parameters, which can maximize our expected rewards. To avoid the high variance problem in the REINFORCE estimator, self-critical sequence training (SCST) BIBREF28 framework is used for sequence training that uses greedy decoding score as a baseline. In SCST, during training, two output sequences are produced: $y^{s}$, obtained by sampling from the probability distribution $P(y^s_t | y^s_1, \ldots , y^s_{t-1}, \mathcal {D})$, and $y^g$, the greedy-decoding output sequence. We define $r(y,y^*)$ as the reward obtained for an output sequence $y$, when the ground truth sequence is $y^*$. The SCST loss can be written as,

where, $R= \sum _{t=1}^{n^{\prime }} \log P(y^s_t | y^s_1, \ldots , y^s_{t-1}, \mathcal {D}) $. However, the greedy decoding method only considers the single-word probability, while the sampling considers the probabilities of all words in the vocabulary. Because of this the greedy reward $r(y^{g},y^*)$ has higher variance than the Monte-Carlo sampling reward $r(y^{s}, y^*)$, and their gap is also very unstable. We experiment with the SCST loss and observe that greedy strategy causes SCST to be unstable in the training progress. Towards this, we introduce a weight history factor similar to BIBREF29. The history factor is the ratio of the mean sampling reward and mean greedy strategy reward in previous $k$ iterations. We update the SCST loss function in the following way:

where $\alpha $ is a hyper-parameter, $t$ is the current iteration, $h$ is the history determines, the number of previous rewards are used to estimate. The denominator of the history factor is used to normalize the current greedy reward $ r(y^{g},y^*)$ with the mean greedy reward of previous $h$ iterations. The numerator of the history factor ensures the greedy reward has a similar magnitude with the mean sample reward of previous $h$ iterations.

## Experimental Setup

With $y^* = \lbrace y^*_1, y^*_2, \ldots , y^*_{m}\rbrace $ as the ground-truth output sequence for a given input sequence $D$, the maximum-likelihood training objective can be written as,

We use a mixed-objective learning function BIBREF32, BIBREF33 to train the final network:

where $\gamma _1$, $\gamma _2$, and $\gamma _3$ correspond to the weights of $\mathcal {L}_{rl}$, $\mathcal {L}_{ml}$, and $\mathcal {L}_{sp}$, respectively. In our experiments, we use the same vocabulary for both the encoder and decoder. Our vocabulary consists of the top 50,000 frequent words from the training data. We use the development dataset for hyper-parameter tuning. Pre-trained GloVe embeddings BIBREF34 of dimension 300 are used in the document encoding step. The hidden dimension of all the LSTM cells is set to 512. Answer tagging features and supporting facts position features are embedded to 3-dimensional vectors. The dropout BIBREF35 probability $p$ is set to $0.3$. The beam size is set to 4 for beam search. We initialize the model parameters randomly using a Gaussian distribution with Xavier scheme BIBREF36. We first pre-train the network by minimizing only the maximum likelihood (ML) loss. Next, we initialize our model with the pre-trained ML weights and train the network with the mixed-objective learning function. The following values of hyperparameters are found to be optimal: (i) $\gamma _1=0.99$, $\gamma _2=0.01$, $\gamma _3=0.1$, (ii) $d_1=300$, $d_2=d_3=3$, (iii) $\alpha =0.9, \beta = 10$, $h=5000$. Adam BIBREF37 optimizer is used to train the model with (i) $ \beta _{1} = 0.9 $, (ii) $ \beta _{2} = 0.999 $, and (iii) $ \epsilon =10^{-8} $. For MTL-QG training, the initial learning rate is set to $0.01$. For our proposed model training the learning rate is set to $0.00001$. We also apply gradient clipping BIBREF38 with range $ [-5, 5] $.

## Experimental Setup ::: Dataset:

We use the HotPotQA BIBREF11 dataset to evaluate our methods. This dataset consists of over 113k Wikipedia-based question-answer pairs, with each question requiring multi-step reasoning across multiple supporting documents to infer the answer. While there exists other multi-hop datasets BIBREF9, BIBREF10, only HotPotQA dataset provides the sentence-level ground-truth labels to locate the supporting facts in the list of documents. We combine the training set ($90,564$) and development set ($7,405$) and randomly split the resulting data, with 80% for training, 10% for development, 10% for testing.

We conduct experiments to evaluate the performance of our proposed and other QG methods using the evaluation metrics: BLEU-1, BLEU-2, BLEU-3, BLEU-4 BIBREF39, ROUGE-L BIBREF40 and METEOR BIBREF41.

Metric for MultiHoping in QG: To assess the multi-hop capability of the question generation model, we introduce additional metric SF coverage, which measures in terms of F1 score. This metric is similar to MultiHop-Enhanced Reward, where we use the question-aware supporting facts predictions network that takes the generated question and document list as input and predict the supporting facts. F1 score measures the average overlap between the predicted and ground-truth supporting facts as computed in BIBREF11.

## Results and Analysis

We first describe some variants of our proposed MultiHop-QG model.

(1) SharedEncoder-QG: This is an extension of the NQG model BIBREF30 with shared encoder for QG and answer-aware supporting fact predictions tasks. This model is a variant of our proposed model, where we encode the document list using a two-layer Bi-LSTM which is shared between both the tasks. The input to the shared Bi-LSTM is word and answer encoding as shown in Eq. DISPLAY_FORM9. The decoder is a single-layer LSTM which generates the multi-hop question.

(2) MTL-QG: This variant is similar to the SharedEncoder-QG, here we introduce another Bi-LSTM layer which takes the question, answer and supporting fact embedding as shown in Eq. DISPLAY_FORM11.

The automatic evaluation scores of our proposed method, baselines, and state-of-the-art single-hop question generation model on the HotPotQA test set are shown in Table TABREF26. The performance improvements with our proposed model over the baselines and state-of-the-arts are statistically significant as $(p <0.005)$. For the question-aware supporting fact prediction model (c.f. SECREF21), we obtain the F1 and EM scores of $84.49$ and $44.20$, respectively, on the HotPotQA development dataset. We can not directly compare the result ($21.17$ BLEU-4) on the HotPotQA dataset reported in BIBREF44 as their dataset split is different and they only use the ground-truth supporting facts to generate the questions.

We also measure the multi-hopping in terms of SF coverage and reported the results in Table TABREF26 and Table TABREF27. We achieve skyline performance of $80.41$ F1 value on the ground-truth questions of the test dataset of HotPotQA.

## Results and Analysis ::: Quantitative Analysis

Our results in Table TABREF26 are in agreement with BIBREF3, BIBREF14, BIBREF30, which establish the fact that providing the answer tagging features as input leads to considerable improvement in the QG system's performance. Our SharedEncoder-QG model, which is a variant of our proposed MultiHop-QG model outperforms all the baselines state-of-the-art models except Semantic-Reinforced. The proposed MultiHop-QG model achieves the absolute improvement of $4.02$ and $3.18$ points compared to NQG and Max-out Pointer model, respectively, in terms of BLEU-4 metric.

To analyze the contribution of each component of the proposed model, we perform an ablation study reported in Table TABREF27. Our results suggest that providing multitask learning with shared encoder helps the model to improve the QG performance from $19.55$ to $20.64$ BLEU-4. Introducing the supporting facts information obtained from the answer-aware supporting fact prediction task further improves the QG performance from $20.64$ to $21.28$ BLEU-4. Joint training of QG with the supporting facts prediction provides stronger supervision for identifying and utilizing the supporting facts information. In other words, by sharing the document encoder between both the tasks, the network encodes better representation (supporting facts aware) of the input document. Such presentation is capable of efficiently filtering out the irrelevant information when processing multiple documents and performing multi-hop reasoning for question generation. Further, the MultiHop-Enhanced Reward (MER) with Rouge reward provides a considerable advancement on automatic evaluation metrics.

## Results and Analysis ::: Qualitative Analysis

We have shown the examples in Table TABREF31, where our proposed reward assists the model to maximize the uses of all the supporting facts to generate better human alike questions. In the first example, Rouge-L reward based model ignores the information `second czech composer' from the first supporting fact, whereas our MER reward based proposed model considers that to generate the question. Similarly, in the second example, our model considers the information `disused station located' from the supporting fact where the former model ignores it while generating the question. We also compare the questions generated from the NQG and our proposed method with the ground-truth questions.

Human Evaluation: For human evaluation, we directly compare the performance of the proposed approach with NQG model. We randomly sample 100 document-question-answer triplets from the test set and ask four professional English speakers to evaluate them. We consider three modalities: naturalness, which indicates the grammar and fluency; difficulty, which measures the document-question syntactic divergence and the reasoning needed to answer the question, and SF coverage similar to the metric discussed in Section SECREF4 except we replace the supporting facts prediction network with a human evaluator and we measure the relative supporting facts coverage compared to the ground-truth supporting facts. measure the relative coverage of supporting facts in the questions with respect to the ground-truth supporting facts. SF coverage provides a measure of the extent of supporting facts used for question generation. For the first two modalities, evaluators are asked to rate the performance of the question generator on a 1–5 scale (5 for the best). To estimate the SF coverage metric, the evaluators are asked to highlight the supporting facts from the documents based on the generated question.

We reported the average scores of all the human evaluator for each criteria in Table TABREF28. The proposed approach is able to generate better questions in terms of Difficulty, Naturalness and SF Coverage when compared to the NQG model.

## Conclusion

In this paper, we have introduced the multi-hop question generation task, which extends the natural language question generation paradigm to multiple document QA. Thereafter, we present a novel reward formulation to improve the multi-hop question generation using reinforcement and multi-task learning frameworks. Our proposed method performs considerably better than the state-of-the-art question generation systems on HotPotQA dataset. We also introduce SF Coverage, an evaluation metric to compare the performance of question generation systems based on their capacity to accumulate information from various documents. Overall, we propose a new direction for question generation research with several practical applications. In the future, we will be focusing on to improve the performance of multi-hop question generation without any strong supporting facts supervision.
