# Asymmetrical Hierarchical Networks with Attentive Interactions for Interpretable Review-Based Recommendation

**Paper ID:** 2001.04346

## Abstract

Recently, recommender systems have been able to emit substantially improved recommendations by leveraging user-provided reviews. Existing methods typically merge all reviews of a given user or item into a long document, and then process user and item documents in the same manner. In practice, however, these two sets of reviews are notably different: users' reviews reflect a variety of items that they have bought and are hence very heterogeneous in their topics, while an item's reviews pertain only to that single item and are thus topically homogeneous. In this work, we develop a novel neural network model that properly accounts for this important difference by means of asymmetric attentive modules. The user module learns to attend to only those signals that are relevant with respect to the target item, whereas the item module learns to extract the most salient contents with regard to properties of the item. Our multi-hierarchical paradigm accounts for the fact that neither are all reviews equally useful, nor are all sentences within each review equally pertinent. Extensive experimental results on a variety of real datasets demonstrate the effectiveness of our method.

## Introduction

The rapid shift from traditional retail and services to online transactions has brought forth a large volume of review data in areas such as e-commerce, dining, tourism, among many others. While such reviews are routinely consulted directly by consumers and affect their decision making, recent work has shown that they can also be exploited by intelligent algorithms. The detailed semantic cues that they harbor not only reveal different aspects (e.g., quality, material, color, etc.) of an item, but also reflect the sentiment of users towards these aspects. Such fine-grained signals are extremely valuable to a recommender system and significantly complement the sparse rating and click-through data, based on which many traditional collaborative filtering methods BIBREF0 have been developed. Thus, there has been a series of studies seeking to harness the potential of reviews in improving the recommendation quality BIBREF1, BIBREF2, BIBREF3, BIBREF4.

These studies have shown that leveraging reviews can indeed boost the recommendation effectiveness quite remarkably. Typically, they associate users with the respective sets of reviews they have written, while associating each item with the set of all reviews that have been written for it. To predict the rating for an unseen user–item pair, in a first step, the embeddings of that user and item are inferred from the respective sets of reviews via a neural network. Then, the two embeddings are matched to predict a numeric rating between them. For example, DeepCoNN BIBREF1 relies on convolutional neural networks to learn user (item) embeddings, and on a factorization machine BIBREF5 to predict ratings. D-ATT BIBREF3 uses dual-attention based networks to learn embeddings, and a simple dot product to predict ratings.

Despite the encouraging progress, existing methods all regard the set of reviews by a user and the set of reviews for an item as the same type of documents, and invoke the same model (or even a shared model) to process them in parallel. In reality, however, the set of reviews for a user is fundamentally different from the set of reviews for an item. In particular, reviews for users correspond to a diverse set of items that they have rated, resulting in notably heterogeneous textual contents with a variety of topics for different items. In contrast, each item's reviews are only about itself, and the contents are thus homogeneous in the sense that the topic is limited to a single narrow domain. For example, Fig. FIGREF1 shows several reviews from Amazon's health domain. User $u$'s historical reviews describe three items, Vitamin C, anti-inflammatory medication, and an air freshener, while all reviews for item $v$ are about itself, i.e., Vitamin D3.

This profound difference necessitates distinct forms of attention to be paid on user reviews as opposed to item reviews, when deciding whether to recommend an item $v$ to a user $u$. To predict $u$'s preference of $v$, it is important to extract from $u$'s reviews those aspects that pertain most to $v$, e.g., comments on items that are similar to $v$. In contrast, from $v$'s reviews, we wish to account for the sentiment of other users with regard to relevant aspects of $v$. If $u$ pays special attention to certain aspects of items similar to $v$, while other users wrote highly about $v$ with regard to these particular aspects, then it is much more likely that $v$ will be of interest to $u$. For example, in Fig. FIGREF1, reviews 1 and 2 of $u$ are about non-prescription medicines that are similar to $v$. In reviews 1 and 2, $u$ mentioned aspects such as “not sourced from genetically modified corn”, “easier to swallow”, “great price”, and “no after taste”, indicating that $u$ considers the source and price and prefers easily swallowed products without after-taste. Meanwhile, reviews 1-3 of $v$ mention that $v$ “have no taste”, is “easy to swallow”, “gmo-free”, and “prices low”, which are opinions expressed by others that match $u$'s preferences. Thus, $v$ is likely to be of interest to $u$, and $u$ indeed marked a 5.0 score on $v$ after purchasing it.

Another vital challenge is how to reliably represent each review. Importantly, sentences are not equally useful within each review. For example, in Fig. FIGREF1, the second sentence in $u$'s review 1, “I take these in the morning and after every workout.” conveys little regarding $u$'s concerns for Vitamin C, and thus is less pertinent than other sentences in the same review. Since including irrelevant sentences can introduce noise and may harm the final embedding quality, it is crucial to aggregate only useful sentences to represent each review.

To address the above challenges, in this paper, we propose an Asymmetrical Hierarchical Network with Attentive Interactions (AHN) for recommendation. AHN progressively aggregates salient sentences to induce review representations, and aggregates pertinent reviews to induce user and item representations. AHN is particularly characterized by its asymmetric attentive modules to flexibly distinguish the learning of user embeddings as opposed to item embeddings. For items, several attention layers are invoked to highlight sentences and reviews that contain rich aspect and sentiment information. For users, we designed an interaction-based co-attentive mechanism to dynamically select a homogeneous subset of contents related to the current target item. In this manner, AHN hierarchically induces embeddings for user–item pairs reflecting the most useful knowledge for personalized recommendation. In summary, our contributions are

We identify the asymmetric attention problem for review-based recommendation, which is important but neglected by existing approaches.

We propose AHN, a novel deep learning architecture that not only captures both of the asymmetric and hierarchical characteristics of the review data, while also enabling interpretability of the results.

We conduct experiments on 10 real datasets. The results demonstrate that AHN consistently outperforms the state-of-the-art methods by a large margin, while providing good interpretations of the predictions.

## Related Work

Exploiting reviews has proven considerably useful in recent work on recommendation. Many methods primarily focus on topic modeling based on the review texts. For example, HFT BIBREF6 employs LDA to discover the latent aspects of users and items from reviews. RMR BIBREF7 extracts topics from reviews to enhance the user and item embeddings obtained by factorizing the rating matrix. TopicMF BIBREF8 jointly factorizes a rating matrix and bag-of-words representations of reviews to infer user and item embeddings. Despite the improvements achieved, these methods only focus on topical cues in reviews, but neglect the rich semantic contents. Moreover, they typically represent reviews as bag-of-words, and thus remain oblivious of the order and contexts of words and sentences in reviews, which are essential for modeling the characteristics of users and items BIBREF1.

Inspired by the astonishing advances of recent deep NLP techniques in various applications BIBREF9, BIBREF10, BIBREF11, BIBREF12, BIBREF13, BIBREF14, there has been increasing interest in studying deep learning models. DeepCoNN BIBREF1 employs CNNs as an automatic feature extractor to encode each user and item into a low-dimensional vector by assessing the relevant set of historical reviews. TransNet BIBREF2 extends DeepCoNN by augmenting the CNN architecture with a multi-task learning scheme to regularize the user and item embeddings towards the target review. These methods, however, lack interpretability BIBREF15 in their results.

To better understand the predictions, several attention-based methods have been developed. D-ATT BIBREF3 incorporates two kinds of attention mechanisms on the words of reviews to find informative words. NARRE BIBREF4 invokes review-level attention weights to aggregate review embeddings to form user (item) embeddings. HUITA BIBREF16 is equipped with a symmetric hierarchical structure, where, at each level (e.g., word level), a regular attention mechanism is employed to infer the representation of the subsequent level (e.g., sentence level). MPCN BIBREF17 models the interactions between a user's reviews and an item's reviews via co-attention based pointers that are learned with the Gumbel-Softmax trick BIBREF18. However, all these methods just learn user and item embeddings in parallel and fail to consider the important differences between the two. As discussed before, this leads to suboptimal predictions.

Unlike the aforementioned methods, our method learns several hierarchical aggregators to infer user (item) embeddings. The aggregators are asymmetric to flexibly pay varying levels of attention to a user's (item's) reviews, so as to enhance the prediction accuracy and model interpretability.

## Our Proposed Model

In this section, we introduce our AHN model in a bottom-up manner. Fig. FIGREF9 illustrates the architecture of AHN.

## Our Proposed Model ::: Sentence Encoding

The sentence encoding layer (omitted in Fig. FIGREF9) aims to transform each sentence (in each review) from a sequence of discrete word tokens to a continuous vector embedding. We use a word embedding model to lay the foundation of this layer. Suppose the sentence $s$ has $l$ words. By employing a word embedding matrix $\mathbf {E} \in \mathbb {R}^{d \times |\mathcal {V}|}$, $s$ can be represented by a sequence $[\mathbf {e}_{1}, ..., \mathbf {e}_{l}]$, where $\mathbf {e}_{i}$ is the embedding of the $i$-th word in $s$, $d$ is the dimensionality of the word embedding, and $\mathcal {V}$ is the whole vocabulary of words. The matrix $\mathbf {E}$ can be initialized using word embeddings such as word2vec BIBREF19 and GloVe BIBREF20, which are widely used in NLP. To refine the word embeddings, $\mathbf {E}$ is fine-tuned during model training.

To learn an embedding for $s$, we employ a bi-directional LSTM BIBREF11 on its constituent word embeddings, and apply max-pooling on the hidden states to preserve the most informative information. That is

where ${\bf s}$ is the embedding of $s$ and

where ${\bf \tilde{e}}_{0}$ is initialized by an all-zero vector ${\bf 0}$.

Suppose a review has $k$ sentences. We can then represent this review by a sequence $[{\bf s}_{1}, ..., {\bf s}_{k}]$, where ${\bf s}_{i}$ is the embedding of the $i$-th sentence in the review, as inferred by Eq. (DISPLAY_FORM6). However, using Eq. (DISPLAY_FORM6), each ${\bf s}_{i}$ only encodes its own semantic meaning, but remains oblivious of any contextual cues from its surrounding sentences in the same review. To further refine the sentence embedding, we introduce a context-encoding layer by employing another bi-directional LSTM on top of the previous layer to model the temporal interactions between sentences, i.e.,

where ${\bf \tilde{s}}_{i}$ is the final embedding of the $i$-th sentence in the review and ${\bf \tilde{s}}_{0}$ is initialized as ${\bf 0}$.

## Our Proposed Model ::: Sentence-Level Aggregation

Next, we develop sentence-level aggregators to embed each review into a compact vector from its constituent sentences. As discussed before, an ideal method should learn review embeddings in an asymmetric style. Thus, we design AHN to learn different attentive aggregators for users and items, respectively, as highlighted in Fig. FIGREF9.

## Our Proposed Model ::: Sentence-Level Aggregation ::: Sentence Aggregator for Items.

Given an item, we are interested in sentences that contain other users' sentiments on different aspects of the item, which are the key factors to determine its overall rating. To build an informative embedding for each review upon such sentences, we use a sentence-level attention network to aggregate the sentence embeddings $[{\bf \tilde{s}}_{1}^{v}, ..., {\bf \tilde{s}}_{k}^{v}]$ as follows, where the superscript $v$ is used to distinguish an item's notation from a user's notation.

Here, $\sum _{i=1}^{k}\alpha _{i}^{v}=1$, and $\alpha _{i}^{v}$ is the attention weight assigned to sentence ${\bf \tilde{s}}_{i}^{v}$. It quantifies the informativeness of sentence ${\bf \tilde{s}}_{i}^{v}$ with respect to $v$'s overall rating, compared to other sentences. The weights $\alpha _{i}^{v}$ are computed by our attentive module, taking the sentence embeddings as the input, as

Here, ${\bf v}_{s} \in \mathbb {R}^{h \times 1}$, ${\bf W}_{s} \in \mathbb {R}^{h \times d}$, and ${\bf \hat{W}}_{s} \in \mathbb {R}^{h \times d}$ are parameters, $\otimes $ is the element-wise product, and $\sigma (\cdot )$ is the sigmoid function. As suggested by BIBREF21, the approximate linearity of $\tanh (\cdot )$ in $[-1, 1]$ could limit the expressiveness of the model, which can be alleviated by introducing a non-linear gating mechanism. Thus, in Eq. (DISPLAY_FORM13), a gate function $\sigma ({\bf \hat{W}}_{s}{\bf \tilde{s}}_{i}^{v})$ is incorporated, which is indeed found effective in our experiments.

## Our Proposed Model ::: Sentence-Level Aggregation ::: Sentence Aggregator for Users.

Next, we develop an interaction-based sentence aggregator for users. Given a user–item pair, we aim to select a homogeneous subset of sentences from each of the user's reviews such that the selected sentences are relevant to the item to be recommended, i.e., the target item. In the following, we introduce a co-attentive network that uses the target item's sentences to guide the search of user's sentences. After the sentence encoding layer, we can represent each review by a matrix ${\bf R} = [{\bf \tilde{s}}_{1}; ...; {\bf \tilde{s}}_{k}] \in \mathbb {R}^{d \times k}$, where $[\cdot ; \cdot ]$ is the concatenation operation. Suppose a user has $n$ reviews and an item has $m$ reviews. Our method first concatenates all sentences of the item to form $[{\bf R}_{1}^{v}; ...; {\bf R}_{m}^{v}] \in \mathbb {R}^{d \times mk}$, whose constituent sentences are all relevant to the target item, and thus can be used to guide the search of similar sentences from the user's reviews. To this end, we iterate over each ${\bf R}_{i}^{u}$ ($1 \le i \le n$) to calculate an affinity matrix as follows, where the superscript $u$ indicates the user notation.

Here, ${\bf M}_{s} \in \mathbb {R}^{d_{s} \times d_{s}}$ is a learnable parameter, $\phi (\cdot )$ is an activation function such as ReLU, and $f(\cdot )$ is a mapping function such as a multi-layer perceptron (MLP). If $f(\cdot )$ is the identity mapping, Eq. (DISPLAY_FORM15) becomes a bilinear mapping. Here, the $(p, q)$-th entry of ${\bf G}_{i}$ represents the affinity between the $p$-th sentence of ${\bf R}_{i}^{u}$ and the $q$-th sentence of $[{\bf R}_{1}^{v}; ...; {\bf R}_{m}^{v}]$.

To measure how relevant the $p$-th sentence of the user's review ${\bf R}_{i}^{u}$ is to the target item, we use the maximum value in the $p$-th row of ${\bf G}_{i}$. The intuition is that, if a user's sentence (i.e., a row of ${\bf G}_{i}$) has a large affinity to at least one sentence of the target item (i.e., a column of ${\bf G}_{i}$) – in other words, the maximal affinity of this row is large – then this user's sentence is relevant to the target item. However, not all sentences of the target item are useful for searching relevant sentences from the user. For instance, in Fig. FIGREF1, the first sentence of the item's review 2, “I received it three days ago.”, conveys little information about the target item, and hence cannot aid in identifying relevant sentences from the user, and indeed may introduce noise into the affinity matrix. To solve this problem, recall that $\alpha _{i}^{v}$ in Eq. (DISPLAY_FORM13) represents how informative an item's sentence is. Thus, we concatenate $\alpha _{i}^{v}$'s of all sentences of the target item to form $\alpha ^{v} \in \mathbb {R}^{1 \times mk}$. Subsequently, we compute an element-wise product between each row of ${\bf G}_{i}$ and the vector $\alpha ^{v}$, i.e., ${\bf G}_{i}\otimes _{\text{row}}\alpha ^{v}$. In this manner, the $(p, q)$-th entry, $({\bf G}_{i} \otimes _{\text{row}} \alpha ^{v})_{pq}$, is high only if the $p$-th sentence of the user is similar to the $q$-th sentence of the target item and the $q$-th sentence of the target item is non-trivial.

By summarizing the above insights, we learn attention weights for the sentences in ${\bf R}_{i}^{u}$ for each $i \in [1, n]$ by

where $\max _{\text{row}}$ refers to row-wise max-pooling for obtaining the maximum affinity. Intuitively, $(\alpha _{i}^{u})_{j}$ is large if the $j$-th sentence in the $i$-th review of the user describes some aspects of some item that is highly similar to the target item. This serves our purpose for selecting a homogeneous subset of sentences from the user.

Next, we use $\alpha _{i}^{u}$ to aggregate the sentences in ${\bf R}_{i}^{u}$ to infer an embedding of the $i$-th review for the user:

where $({\bf R}_{i}^{u})_{*j}$ is the $j$-th column of ${\bf R}_{i}^{u}$. Recall that ${\bf R}_{i}^{u} = [{\bf \tilde{s}}_{1}^{u}; ...; {\bf \tilde{s}}_{k}^{u}]$, where each column of ${\bf R}_{i}^{u}$ is a sentence embedding. Note that our method iterates over $i$ for $i \in [1, n]$ to calculate all review embeddings ${\bf r}_{1}^{u}$, ..., ${\bf r}_{n}^{u}$.

## Our Proposed Model ::: Sentence-Level Aggregation ::: Remark.

Our co-attentive mechanism employs the idea of sequence pair modeling but notably differs from the conventional co-attention used in QA systems BIBREF9, BIBREF22, BIBREF23. First, we only consider one side of the affinity matrix, i.e., the user. Second, our affinity matrix is adapted by row-wise multiplication of $\alpha ^{v}$ to quantify the utility of the item's sentences. Thus, our method is designed specifically for learning asymmetric attentions from user–item interactions.

## Our Proposed Model ::: Review-Level Aggregation

From Eq. (DISPLAY_FORM12), we obtain review embeddings for an item, ${\bf r}_{1}^{v}$, ..., ${\bf r}_{m}^{v}$. From Eq. (DISPLAY_FORM17), we obtain review embeddings for a user, ${\bf r}_{1}^{u}$, ..., ${\bf r}_{n}^{u}$. As shown in Fig. FIGREF9, based on these review embeddings, we develop review-level aggregators to infer an embedding for each user and item, respectively.

As discussed before, different reviews exhibit different degrees of informativeness in modeling users and items. In particular, an item's reviews are homogeneous. Thus, we are interested in reviews with rich descriptions regarding its relevant aspects and corresponding sentiments, such as the reviews 1–3 of $v$ in Fig. FIGREF1, compared with the less informative review 4 of $v$. To attend to such reviews, similar to Eq. (DISPLAY_FORM12), we aggregate the review embeddings to represent an item by

where $\sum _{i=1}^{m}\beta _{i}^{v} = 1$, and $\beta _{i}^{v}$ is the attention weight assigned to review ${\bf r}_{i}^{v}$. It quantifies the informativeness of the review ${\bf r}_{i}^{v}$ with respect to $v$'s overall rating. $\beta _{i}^{v}$ is produced by an attentive module with gating mechanism as follows:

where ${\bf v}_{r} \in \mathbb {R}^{h \times 1}$, ${\bf W}_{r} \in \mathbb {R}^{h \times d}$, and ${\bf \hat{W}}_{r} \in \mathbb {R}^{h \times d}$ are model parameters.

At the same time, a user's reviews are heterogeneous concerning a variety of items that the user has purchased, and not all reviews are relevant to the target item. Thus, similar to Eq. (DISPLAY_FORM15) and Eq. (DISPLAY_FORM16), given a user–item pair, a review-level co-attentive network is designed to select reviews from the user as guided by the reviews of the item.

Specifically, an affinity matrix at the review level

is computed, where ${\bf M}_{r} \in \mathbb {R}^{d_{r} \times d_{r}}$ is a learnable parameter. Here, the $(p, q)$-th entry of ${\bf G}$ represents the affinity between the $p$-th review of the user and the $q$-th review of the item.

Then, attention weights for the reviews of the user

are obtained, where $\beta ^{v} = [\beta _{1}^{v}, ..., \beta _{m}^{v}]$ was obtained by Eq. (DISPLAY_FORM21) for the item. It is introduced to adapt ${\bf G}$ to encode important reviews of the item. Finally, we aggregate the review embeddings to represent a user by the following weighted sum.

## Our Proposed Model ::: Review-Level Aggregation ::: Encoding Latent Rating Patterns.

Although the embeddings ${\bf \tilde{u}}$ and ${\bf \tilde{v}}$ contain rich semantic information from reviews, there are some latent characteristics of users (items) that are not encoded by their reviews, but can be inferred from the rating patterns. For instance, a picky user might tend to uniformly pick lower ratings than a more easygoing user. To encode such personalized preferences, as inspired by BIBREF0, we embed a one-hot representation of the ID of each user (item) using an MLP, and obtain an embedding vector ${\bf \hat{u}}$ (${\bf \hat{v}}$) for the user (item). This vector directly correlates with the ratings of a user (item), and is thus able to capture the latent rating patterns. Then, as illustrated in Fig. FIGREF9, we concatenate ${\bf \tilde{u}}$ and ${\bf \hat{u}}$ to obtain the final embedding of a user, i.e., ${\bf u} = [{\bf \tilde{u}}; {\bf \hat{u}}]$, and concatenate ${\bf \tilde{v}}$ and ${\bf \hat{v}}$ to obtain the final embedding of an item, i.e., ${\bf v} = [{\bf \tilde{v}}; {\bf \hat{v}}]$.

## Our Proposed Model ::: Prediction Layer

As shown by the top part of Fig. FIGREF9, the prediction layer receives ${\bf u}$ and ${\bf v}$, and concatenates them to $[{\bf u}; {\bf v}]$, which is then fed into a function $g(\cdot )$ to predict the rating. In this work, we realize $g(\cdot )$ as a parameterized factorization machine (FM) BIBREF5, which is effective to model the pairwise interactions between the input features for improving recommendation performance. Given an input ${\bf x} \in \mathbb {R}^{d \times 1}$, $g(\cdot )$ is defined as

where $b$ is a bias term, ${\bf w}$ is a parameter for linear regression, $\lbrace {\bf z}_{i}\rbrace _{i=1}^{d}$ are the factorized parameter for modeling the pairwise interactions between ${\bf x}_{i}$ and ${\bf x}_{j}$, $\mathinner {\langle {\cdot , \cdot }\rangle }$ denotes the inner product, and the output of $g({\bf x})$ is the predicted rating.

To learn model parameters, we minimize the difference between the true ratings and the predicted ratings, as measured by the mean squared error

where $c$ is the total number of user–item pairs in the training data, and $y_{i}$ is the true rating of the $i$-th user–item pair. The $\ell $ in Eq. (DISPLAY_FORM28) serves as our loss function for model training.

## Experiments

In this section, we evaluate our AHN model on several real datasets and compare it with state-of-the-art approaches.

## Experiments ::: Datasets

We conducted experiments on 10 different datasets, including 9 Amazon product review datasets for 9 different domains, and the large-scale Yelp challenge dataset on restaurant reviews. Table TABREF30 summarizes the domains and statistics for these datasets. Across all datasets, we follow the existing work BIBREF3, BIBREF17 to perform preprocessing to ensure they are in a $t$-core fashion, i.e., the datasets only include users and items that have at least $t$ reviews. In our experiments, we evaluate the two cases of $t=5$ and $t=10$. For the Yelp dataset, we follow BIBREF3 to focus on restaurants in the AZ metropolitan area. For each dataset, we randomly split the user–item pairs into $80\%$ training set, $10\%$ validation set, and $10\%$ testing set. When learning the representations for users and items, we only use their reviews from the training set, and none from the validation and testing sets. This ensures a practical scenario where we cannot include any future reviews into a user's (item's) history for model training.

## Experiments ::: Compared Methods

We compare our model with both conventional approaches and state-of-the-art approaches, including Factorization Machines (FM) BIBREF5, SVD BIBREF0, Probabilistic Matrix Factorization (PMF) BIBREF24, Nonnegative Matrix Factorization (NMF) BIBREF25, DeepCoNN BIBREF1, D-ATT BIBREF3, MPCN BIBREF17, and HUITA BIBREF16.

Among these methods, FM, SVD, PMF, and NMF are rating-based collaborative filtering methods. DeepCoNN, D-ATT, MPCN, and HUITA are state-of-the-art methods that leverage the semantic information in reviews for improved performance. Specifically, DeepCoNN uses the same CNN module to learn user and item embeddings based on their reviews for recommendation. D-ATT extends DeepCoNN by adding a dual-attention layer at word-level before convolution. MPCN attends to informative reviews by several pointers. HUITA uses a symmetric hierarchical structure to infer user (item) embeddings using regular attention mechanisms. It is worth noting that all of the above review-based methods regard user reviews and item reviews as the same type of documents and process them in an identical way.

Finally, to gain further insights on some of the design choices of our AHN model, we compare AHN with its variants, which will be discussed later in the ablation analysis.

## Experiments ::: Experimental Settings

The parameters of the compared methods are selected based on their performance on the validation set. Specifically, for FM, the dimensionality of the factorized parameters is 10. For SVD, PMF, and NMF, the number of factors is set to 50. DeepCoNN uses 100 convolutional kernels with window size 3. D-ATT uses 200 filters and window size 5 for local attention; 100 filters and window sizes [2, 3, 4] for global attention. MPCN uses 3 pointers, and hidden dimensionality of 300 for inferring affinity matrix. HUITA uses 200 filters in the word-level CNN with window size 3, and 100 filters in the sentence-level CNN with window size 3.

For our AHN model, the dimensionality of the hidden states of the BiLSTM is set to 150. The dimensionality of the user and item ID embeddings are set to 300. The dimensionality of ${\bf M}_{s}$ (${\bf M}_{r}$) in Eq. (DISPLAY_FORM15) (Eq. (DISPLAY_FORM22)) is 300. We apply dropout BIBREF26 with rate $0.5$ after the fully connected layer to alleviate the overfitting problem. The loss function is optimized by Adam BIBREF27, with a learning rate of 0.0002 and a maximum of 10 epochs.

For the methods DeepCoNN, D-ATT, and HUITA, the pre-trained GloVe BIBREF20 are used to initialize the word embeddings. For MPCN and our AHN, the word embeddings are learned from scratch since using pre-trained embeddings generally degrades their performance. For all methods, the dimensionality of the word embedding is set to 300. We independently repeat each experiment 5 times, and use the averaged mean square error (MSE) BIBREF1 to quantitatively evaluate the performance.

## Experiments ::: Experimental Results

Table TABREF31 summarizes the results of the compared approaches on the 5-core datasets. We have several observations from the results. First, review-based methods generally outperform rating-based methods. This validates the usefulness of reviews in providing fine-grained information for refining user and item embeddings for improving the accuracy of rating prediction. Second, methods that distinguish reviews, such as D-ATT and MPCN, often outperform DeepCoNN, which suggests that different reviews exhibit different degrees of importance for modeling users and items. We also observe that HUITA does not show superiority over DeepCoNN. This may stem from its symmetric style of attention learning, which does not make much sense when reviews are heterogeneous. Finally, the proposed AHN consistently outperforms other methods, which demonstrates the effectiveness of distinguishing the learning of user and item embeddings via asymmetric attentive modules so as to infer more reasonable attention weights for recommendation.

Table TABREF32 presents the results on the 10-core datasets, from which the Automotive dataset is excluded because only very few users and items are left after applying the 10-core criterion on it. In contrast to Table TABREF31, all methods in general achieve better results in Table TABREF32, since more ratings and reviews become available for each user and item. In this case, we observe that D-ATT often outperforms MPCN. This may be because the Gumbel-Softmax pointers in MPCN make hard selections on reviews, thereby filtering out many reviews that may result in a significant loss of information. This problem is more severe when users (items) have more useful reviews, as in the 10-core scenario. Additionally, we observe that the performance gaps between AHN and the compared methods become larger. Specifically, summarizing the relative improvements of AHN over each of the review-based methods in Fig. FIGREF33, we observe that AHN generally gains more on the 10-core datasets, with absolute gains of up to $11.6\%$ (DeepCoNN), $7.0\%$ (D-ATT), $13.8\%$ (MPCN), and $8.4\%$ (HUITA). This suggests that the more reviews each user and item has, the more important it is to perform proper attention learning on relevant reviews and sentences on both the user and item sides.

## Experiments ::: Case Study

We next investigate the interpretability of AHN. Fig. FIGREF43(a) and (b) show the attention weights of AHN on the top three reviews of a pair of user and item on the Health dataset, where the item is a sleep aid medicine. In each of the user's reviews, the highlighted words indicate the item described by the review. As can be seen, the first two items “krill oil” and “pain relief patch” are more relevant to the item “sleep aid medicine” than the “laundry detergent” in the lowest-weighted review. On the other hand, the top two reviews of the item are more informative with regard to the aspects of the item than the last review, which only discusses packaging, a rather marginal aspect of medication. Thus, the review-level attention weights of AHN are meaningful.

Fig. FIGREF43(c) and (d) zoom into the attention weights of AHN on the top three sentences of the first review of the user and item, respectively. The highlighted words indicate the reason of why the sentences are ranked highly. Apparently, the user cares about the taste of the medicine and prefers easily-swallowed softgels, while the item indeed appears to taste good and is easy to swallow. Although the first two sentences in Fig. FIGREF43(d) are short, they convey more useful information than the lowest-weighted sentence. Thus, the sentence-level attention weights are also meaningful. This explains why AHN predicts a 4.4 rating score on this user–item pair, close to the true rating 5.0 given by the user.

## Experiments ::: Ablation Analysis

Table TABREF45 presents the results of our ablation analysis using four datasets. In the table, AHN is our original model. In (a), the item's attention modules are replaced by average-pooling. In (b), the user co-attention modules are replaced by attention modules similar to the item ones and this thus constitutes a symmetric model. In (c), we remove the row-wise multiplication between the affinity matrix and the attention weights in Eqs. (DISPLAY_FORM16) and (DISPLAY_FORM23). In (d), the parameterized factorization machine is replaced by a dot product. In (e), the gating mechanisms in Eqs. (DISPLAY_FORM13) and (DISPLAY_FORM21) are removed.

From Table TABREF45, we observe that different variants of AHN show suboptimal results to various degrees. Comparing with (a), we can observe the importance of considering attention weights on the sentences and reviews of each item. The degraded MSEs of (b) suggest that our asymmetric design in the model architecture is essential. The results of (c) validate our design of the attention-adapted affinity matrix in Eqs. (DISPLAY_FORM16) and (DISPLAY_FORM23). The substantial MSE drops for (d) establish the superiority of using FM as the prediction layer. The comparison between (e) and AHN suggests the effectiveness of the gating mechanisms. Thus, the results of the ablation study validate the design choices of our model architecture.

## Conclusions

In this work, we highlight the asymmetric attention problem for review-based recommendation, which has been ignored by existing approaches. To address it, we propose a flexible neural architecture, AHN, which is characterized by its asymmetric attentive modules for distinguishing the learning of user embeddings and item embeddings from reviews, as well as by its hierarchical paradigm to extract fine-grained signals from sentences and reviews. Extensive experimental results on datasets from different domains demonstrate the effectiveness and interpretability of our method.
