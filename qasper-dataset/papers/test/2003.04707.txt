# Neuro-symbolic Architectures for Context Understanding

**Paper ID:** 2003.04707

## Abstract

Computational context understanding refers to an agent's ability to fuse disparate sources of information for decision-making and is, therefore, generally regarded as a prerequisite for sophisticated machine reasoning capabilities, such as in artificial intelligence (AI). Data-driven and knowledge-driven methods are two classical techniques in the pursuit of such machine sense-making capability. However, while data-driven methods seek to model the statistical regularities of events by making observations in the real-world, they remain difficult to interpret and they lack mechanisms for naturally incorporating external knowledge. Conversely, knowledge-driven methods, combine structured knowledge bases, perform symbolic reasoning based on axiomatic principles, and are more interpretable in their inferential processing; however, they often lack the ability to estimate the statistical salience of an inference. To combat these issues, we propose the use of hybrid AI methodology as a general framework for combining the strengths of both approaches. Specifically, we inherit the concept of neuro-symbolism as a way of using knowledge-bases to guide the learning progress of deep neural networks. We further ground our discussion in two applications of neuro-symbolism and, in both cases, show that our systems maintain interpretability while achieving comparable performance, relative to the state-of-the-art.

## Explainability through Context Understanding

Context understanding is a natural property of human cognition, that supports our decision-making capabilities in complex sensory environments. Humans are capable of fusing information from a variety of modalities|e.g., auditory, visual|in order to perform different tasks, ranging from the operation of a motor vehicle to the generation of logical inferences based on commonsense. Allen Newell and Herbert Simon described this sense-making capability in their theory of cognition BIBREF0, BIBREF1: through sensory stimuli, humans accumulate experiences, generalize, and reason over them, storing the resulting knowledge in memory; the dynamic combination of live experience and distilled knowledge during task-execution, enables humans to make time-effective decisions and evaluate how good or bad a decision was by factoring in external feedback.

Endowing machines with this sense-making capability has been one of the long-standing goals of Artificial Intelligence (AI) practice and research, both in industry and academia. Data-driven and knowledge-driven methods are two classical techniques in the pursuit of such machine sense-making capability. Sense-making is not only a key for improving machine autonomy, but is a precondition for enabling seamless interaction with humans. Humans communicate effectively with each other, thanks to their shared mental models of the physical world and social context BIBREF2. These models foster reciprocal trust by making contextual knowledge transparent; they are also crucial for explaining how decision-making unfolds. In a similar fashion, we can assert that `explainable AI' is a byproduct or an affordance of computational context understanding and is predicated on the extent to which humans can introspect the decision processes that enable machine sense-making BIBREF3.

## Context Understanding through Neuro-symbolism

From the definitions of `explainable AI' and `context understanding,' in the previous section, we can derive the following corollary:

The explainability of AI algorithms is related to how context is processed, computationally, based on the machine's perceptual capabilities and on the external knowledge resources that are available.

Along this direction, the remainder of this chapter explores two concrete scenarios of context understanding, realized by neuro-symbolic architectures|i.e., hybrid AI frameworks that instruct machine perception (based on deep neural networks) with knowledge graphs. These examples were chosen to illustrate the general applicability of neuro-symbolism and its relevance to contemporary research problems.

Specifically, section SECREF3 considers context understanding for autonomous vehicles: we describe how a knowledge graph can be built from a dataset of urban driving situations and how this knowledge graph can be translated into a continuous vector-space representation. This embedding space can be used to estimate the semantic similarity of visual scenes by using neural networks as powerful, non-linear function approximators. Here, models may be trained to make danger assessments of the visual scene and, if necessary, transfer control to the human in complex scenarios. The ability to make this assessment is an important capability for autonomous vehicles, when we consider the negative ramifications for a machine to remain invariant to changing weather conditions, anomalous behavior of dynamic obstacles on the road (e.g., other vehicles, pedestrians), varied lighting conditions, and other challenging circumstances. We suggest neuro-symbolic fusion as one solution and, indeed, our results show that our embedding space preserves the semantic properties of the conceptual elements that make up visual scenes.

In section SECREF17, we describe context understanding for language tasks. Here, models are supplied with three separate modalities: external commonsense knowledge, unstructured textual context, and a series of answer candidates. In this task, models are tested on their ability to fuse together these disparate sources of information for making the appropriate logical inferences. We designed methods to extract adequate semantic structures (i.e., triples) from two comprehensive commonsense knowledge graphs, ConceptNet BIBREF6 and Atomic BIBREF7, and to inject this external context into language models. In general, open-domain linguistic context is useful for different tasks in Natural Language Processing (NLP), including: information-extraction, text-classification, extractive and abstractive summarization, and question-answering (QA). For ease of quantitative evaluation, we consider a QA task in section SECREF17. In particular, the task is to select the correct answer from a pool of candidates, given a question that specifically requires commonsense to resolve. For example, the question, If electrical equipment won't power on, what connection should be checked? is associated with `company', `airport', `telephone network', `wires', and `freeway'(where `wires' is the correct answer choice). We demonstrate that our proposed hybrid architecture out-performs the state-of-the-art neural approaches that do not utilize structured commonsense knowledge bases. Furthermore, we discuss how our approach maintains explainability in the model's decision-making process: the model has the joint task of learning an attention distribution over the commonsense knowledge context which, in turn, depends on the knowledge triples that were conceptually most salient for selecting the correct answer candidate, downstream. Fundamentally, the goal of this project is to make human interaction with chatbots and personal assistants more robust. For this to happen, it is crucial to equip intelligent agents with a shared understanding of general contexts, i.e., commonsense. Conventionally, machine commonsense had been computationally articulated using symbolic languages|Cyc being one of the most prominent outcomes of this approach BIBREF8. However, symbolic commonsense representations are neither scalable nor comprehensive, as they depend heavily on the knowledge engineering experts that encode them. In this regard, the advent of deep learning and, in particular, the possibility of fusing symbolic knowledge into sub-symbolic (neural) layers, has recently led to a revival of this AI research topic.

## Applications of Neuro-symbolism ::: Application I: Learning a Knowledge Graph Embedding Space for Context Understanding in Automotive Driving Scenes ::: Introduction

Recently, there has been a significant increase in the investment for autonomous driving (AD) research and development, with the goal of achieving full autonomy in the next few years. Realizing this vision requires robust ML/AI algorithms that are trained on massive amounts of data. Thousands of cars, equipped with various types of sensors (e.g., LIDAR, RGB, RADAR), are now deployed around the world to collect this heterogeneous data from real-world driving scenes. The primary objective for AD is to use these data to optimize the vehicle's perception pipeline on such tasks as: 3D object detection, obstacle tracking, object trajectory forecasting, and learning an ideal driving policy. Fundamental to all of these tasks will be the vehicle's context understanding capability, which requires knowledge of the time, location, detected objects, participating events, weather, and various other aspects of a driving scene. Even though state-of-the-art AI technologies are used for this purpose, their current effectiveness and scalability are insufficient to achieve full autonomy. Humans naturally exhibit context understanding behind the wheel, where the decisions we make are the result of a continuous evaluation of perceptual cues combined with background knowledge. For instance, human drivers generally know which area of a neighborhood might have icy road conditions on a frigid winter day, where flooding is more frequent after a heavy rainfall, which streets are more likely to have kids playing after school, and which intersections have poor lighting. Currently, this type of common knowledge is not being used to assist self-driving cars and, due to the sample-inefficiency of current ML/AI algorithms, vehicle models cannot effectively learn these phenomena through statistical observation alone. On March 18, 2018, Elaine Herzberg’s death was reported as the first fatality incurred from a collision with an autonomous vehicle. An investigation into the collision, conducted by The National Transportation Safety Board (NTSB), remarks on the shortcomings of current AD and context understanding technologies. Specifically, NTSB found that the autonomous vehicle incorrectly classified Herzberg as an unknown object, a vehicle, and then a bicycle within the complex scene as she walked across the road. Further investigation revealed that the system design did not include consideration for pedestrians walking outside of a crosswalk, or jaywalking BIBREF9. Simply put, the current AD technology lacks fundamental understanding of the characteristics of objects and events within common scenes; this suggests that more research is required in order to achieve the vision of autonomous driving.

Knowledge Graphs (KGs) have been successfully used to manage heterogeneous data within various domains. They are able to integrate and structure data and metadata from multiple modalities into a unified semantic representation, encoded as a graph. More recently, KGs are being translated into latent vector space representations, known as Knowledge Graph Embeddings (KGEs), that have been shown to improve the performance of machine learning models when applied to certain downstream tasks, such as classification BIBREF10, BIBREF11. Given a KG as a set of triples, KGE algorithms learn to create a latent representation of the KG entities and relations as continuous KGE vectors. This encoding allows KGEs to be easily manipulated and integrated with machine learning algorithms. Motivated by the shortcomings of current context understanding technologies, along with the promising outcomes of KGEs, our research focuses on the generation and evaluation of KGEs on AD data. Before directly applying KGEs on critical AD applications, however, we evaluate the intrinsic quality of KGEs across multiple metrics and KGE algorithms BIBREF12. Additionally, we present an early investigation of using KGEs for a selected use-case from the AD domain.

## Applications of Neuro-symbolism ::: Application I: Learning a Knowledge Graph Embedding Space for Context Understanding in Automotive Driving Scenes ::: Scene Knowledge Graphs

Dataset. To promote and enable further research on autonomous driving, several benchmark datasets have been made publicly available by companies in this domain BIBREF13. NuScenes is a benchmark dataset of multimodal vehicular data, recently released by Aptiv BIBREF14 and used for our experiments. NuScenes consists of a collection of 20-second driving scenes, with $\sim $40 sub-scenes sampled per driving scene (i.e., one every 0.5 seconds). In total, NuScenes includes 850 driving scenes and 34,149 sub-scenes. Each sub-scene is annotated with detected objects and events, each defined within a taxonomy of 23 object/event categories.

Scene Ontology. In autonomous driving, a scene is defined as an observable volume of time and space BIBREF15. On the road, a vehicle may encounter many different situations|such as merging onto a divided highway, stopping at a traffic light, and overtaking another vehicle|all of which are considered as common driving scenes. A scene encapsulates all relevant information about a particular situation, including data from vehicular sensors, objects, events, time and location. A scene can also be divided into a sequence of sub-scenes. As an example, a 20-second drive consisting primarily of the vehicle merging into a highway could be considered as a scene. In addition, all the different situations the vehicle encounters within these 20 seconds can also be represented as (sub-)scenes. In this case, a scene may be associated with a time interval and spatial region while a sub-scene may be associated with a specific timestamp and a set of spatial coordinates. This semantic representation of a scene is formally defined in the Scene Ontology (see figure FIGREF8(a), depicted in Protege). To enable the generation of a KG from the data within NuScenes, the Scene Ontology is extended to include all the concepts (i.e., objects and event categories) found in the NuScenes dataset.

Generating Knowledge Graphs. The Scene Ontology identifies events and features-of-interests (FoIs) as top-level concepts. An event or a FoI may be associated with a Scene via the includes relation. FoIs are associated with events through the isParticipantOf relation. Figure FIGREF8(b) shows a subset of the FoIs and events defined by the Scene Ontology. In generating the scenes' KG, each scene and sub-scene found in NuScenes is annotated using the Scene Ontology. Table TABREF9 shows some basic statistics of the generated KG.

## Applications of Neuro-symbolism ::: Application I: Learning a Knowledge Graph Embedding Space for Context Understanding in Automotive Driving Scenes ::: Knowledge Graph Embeddings

KGE Algorithms. KGE algorithms enable the ability to easily feed knowledge into ML algorithms and improve the performance of learning tasks, by translating the knowledge contained in knowledge graphs into latent vector space representation of KGEs BIBREF16. To select candidate KGE algorithms for our evaluation, we referred to the classification of KGE algorithms provided by Wang et al. BIBREF17. In this work, KGE algorithms are classified into two primary categories: (1) Transitional distance-based algorithms and (2) Semantic matching-based models. Transitional distance-based algorithms define the scoring function of the model as a distance-based measure, while semantic matching-based algorithms define it as a similarity measure. Here, entity and relation vectors interact via addition and subtraction in the case of Transitional distance-based models; in semantic matching-based models, the interaction between entity and relation vectors is captured by multiplicative score functions BIBREF18.

Initially, for our study we had selected one algorithm from each class: TransE BIBREF19 to represent the transitional distance-based algorithms and RESCAL BIBREF20 to represent the semantic matching-based algorithms. However, after experimentation, RESCAL did not scale well for handling large KGs in our experiments. Therefore, we also included HolE BIBREF21|an efficient successor of RESCAL|in the evaluation. A brief summary of each algorithm is provided for each model, below:

TransE: the TransE model is often considered to be the most-representative of the class of transitional distance-based algorithms BIBREF17. Given a triple (h, r, t) from the KG, TransE encodes h, r and t as vectors, with r represented as a transition vector from h to t: $\mathbf {h} + \mathbf {r} \approx \mathbf {t}$. Since both entities and relations are represented as vectors, TransE is one of the most efficient KGE algorithms, with $\mathcal {O}(n d + m d)$ space complexity and $\mathcal {O}(n_t d)$ time complexity ($n_t$ is the number of training triples).

RESCAL: RESCAL is capable of generating an expressive knowledge graph embedding space, due to its ability to capture complex patterns over multiple hops in the KG. RESCAL encodes relations as matrices and captures the interaction between entities and relations using a bi-linear scoring function. Though the use of a matrix to encode each relation yields improved expressivity, it also limits RESCAL’s ability to scale with large KGs. It has $\mathcal {O}(n d + m d^2)$ space complexity and $\mathcal {O}(n_t d^2)$ time complexity.

HolE: HoLE is a more efficient successor of RESCAL, addressing its space and time complexity issues, by encoding relations as vectors without sacrificing the expressivity of the model. By using circular correlation operation BIBREF21, it captures the pairwise interaction of entities as composable vectors. This optimization yields $\mathcal {O} (n d + m d)$ space complexity and $\mathcal {O}(n_t d \log d)$ time complexity.

Visualizing KGEs. In order to visualize the generated KGE, a “mini" KG from the NuScenes-mini dataset was created. Specifically, 10 scenes were selected (along with their sub-scenes) to generate the KG, and the TransE algorithm was used to learn the embeddings. When training the KGEs, we chose the dimension of the vectors to be 100. To visualize the embeddings in 2-dimensional (2D) space, the dimensions are reduced using the t-Distributed Stochastic Neighbor Embedding (t-SNE) BIBREF22 projection. Figure FIGREF11(a) shows the resulting embeddings of the NuScenes dataset. To denote interesting patterns that manifest in the embeddings, instances of Car (a FoI) and the events in which they participate are highlighted. In this image, events such as parked car, moving car, and stopped car are clustered around entities of type Car. This shows that the isParticipantOf relations defined in the KG are maintained within the KG embeddings.

## Applications of Neuro-symbolism ::: Application I: Learning a Knowledge Graph Embedding Space for Context Understanding in Automotive Driving Scenes ::: Intrinsic Evaluation

Here, we deviate slightly from the prior work in evaluating KGE algorithms, which evaluate KGEs based downstream task performance. Instead, we focus on an evaluation that uses only metrics that quantify the intrinsic quality of KGEs BIBREF23: categorization measure, coherence measure, and semantic transition distance. Categorization measures how well instances of the same type cluster together. To quantify this quality, all vectors of the same type are averaged together and the cosine similarity is computed between the averaged vector and the typed class. The Coherence measure quantifies the proportion of neighboring entities that are of the same type; the evaluation framework proposes that, if a set of entities are typed by the class, those entities should form a cluster in the embedding space with the typed class as the centroid. Adapted from the word embedding literature, Semantic Transitional Distance captures the relational semantics of the KGE: if a triple $(h,r,t)$ is correctly represented in the embedding space, the transition distance between the vectors representing $(\mathbf {h+r})$ should be close to $\mathbf {t}$. This is quantified by computing the cosine similarity between $(\mathbf {h+r})$ and $\mathbf {t}$.

Results. Evaluation results are reported with respect to each algorithm and metric. Figure FIGREF13 shows the evaluation results of categorization measure, coherence measure, and semantic transitional distance|for each KGE algorithm. The NuScenes KG, generated from the NuScenes-trainval dataset, is large in terms of both the number of triples and number of entities (see Table TABREF9). Hence, RESCAL did not scale well to this dataset. For this reason, we only report the evaluation results for TransE and HolE. When considering the KGE algorithms, TransE's performance is consistently better across metrics, compared to HolE's performance. However, it is interesting to note that HolE significantly outperforms TransE for some classes/relations. When considering the evaluation metrics, it is evident that the categorization measure and semantic transitional distance are able to capture the quality of type semantics and relational semantics, respectively. The value of the coherence measure, however, is zero for HoLE in most cases and close to zero for TransE in some cases. In our experimental setting, the poor performance with respect to the coherence measure may suggest that it may not be a good metric for evaluating KGEs in the AD domain.

## Applications of Neuro-symbolism ::: Application I: Learning a Knowledge Graph Embedding Space for Context Understanding in Automotive Driving Scenes ::: A use-case from the AD domain

We report preliminary results from our investigation into using KGEs for a use-case in the AD domain. More specifically, we apply KGEs for computing scene similarity. In this case, the goal is to find (sub-)scenes that are characteristically similar, using the learned KGEs. Given a set of scene pairs, we choose the pair with the highest cosine similarity as the most similar. Figure FIGREF15 shows an illustration of the two most similar sub-scenes, when the list of pairs include sub-scenes from different scenes. An interesting observation is that the black string of objects in sub-scene (a) are Barriers (a Static Object), and the orange string of objects in sub-scene (b) are Stopped Cars. This example suggests that the KGE-based approach could identify sub-scenes that share similar characteristics even though the sub-scenes are visually dissimilar.

## Applications of Neuro-symbolism ::: Application I: Learning a Knowledge Graph Embedding Space for Context Understanding in Automotive Driving Scenes ::: Discussion

We presented an investigation of using KGEs for AD context understanding, along with an evaluation of the intrinsic quality of KGEs. The evaluation suggests that KGEs are specifically able to capture the semantic properties of a scene knowledge graph (e.g., isParticipantOf relation between objects and events). More generally, KGE algorithms are capable of translating semantic knowledge, such as type and relational semantics to KGEs. When considering the different KGE algorithms, we report that the transitional distance-based algorithm, TransE, shows consistent performance across multiple quantitative KGE-quality metrics. Our evaluation further suggests that some quality metrics currently in use, such as the coherence measure, may not be effective in measuring the quality of the type semantics from KGEs, in the AD domain. Finally, in applying the learned KGEs to a use-case of importance in the AD domain, we shed some light on the effectiveness of leveraging KGEs in capturing AD scene similarity.

## Applications of Neuro-symbolism ::: Application II: Neural Question-Answering using Commonsense Knowledge Bases ::: Introduction

Recently, many efforts have been made towards building challenging question-answering (QA) datasets that, by design, require models to synthesize external commonsense knowledge and leverage more sophisticated reasoning mechanisms BIBREF24, BIBREF25, BIBREF26, BIBREF27, BIBREF28. Two directions of work that try to solve these tasks are: purely data-oriented and purely knowledge-oriented approaches. The data-oriented approaches generally propose to pre-train language models on large linguistic corpora, such that the model would implicitly acquire “commonsense” through its statistical observations. Indeed, large pre-trained language models have achieved promising performance on many commonsense reasoning benchmarks BIBREF29, BIBREF30, BIBREF31, BIBREF32. The main downsides of this approach are that models are difficult to interpret and that they lack mechanisms for incorporating explicit commonsense knowledge. Conversely, purely knowledge-oriented approaches combine structured knowledge bases and perform symbolic reasoning, on the basis of axiomatic principles. Such models enjoy the property of interpretability, but often lack the ability to estimate the statistical salience of an inference, based on real-world observations. Hybrid models are those that attempt to fuse these two approaches, by extracting knowledge from structured knowledge bases and using the resulting information to guide the learning paradigm of statistical estimators, such as deep neural network models.

Different ways of injecting knowledge into models have been introduced, such as attention-based gating mechanisms BIBREF33, key-value memory mechanisms BIBREF34, BIBREF35, extrinsic scoring functions BIBREF36, and graph convolution networks BIBREF37, BIBREF38. Our approach is to combine the powerful pre-trained language models with structured knowledge, and we extend previous approaches by taking a more fine-grained view of commonsense. The subtle differences across the various knowledge types have been discussed at length in AI by philosophers, computational linguists, and cognitive psychologists BIBREF39. At the high level, we can identify declarative commonsense, whose scope encompasses factual knowledge, e.g., `the sky is blue' and `Paris is in France'; taxonomic knowledge, e.g., `football players are athletes' and `cats are mammals'; relational knowledge, e.g., `the nose is part of the skull' and `handwriting requires a hand and a writing instrument'; procedural commonsense, which includes prescriptive knowledge, e.g., `one needs an oven before baking cakes' and `the electricity should be off while the switch is being repaired' BIBREF40; sentiment knowledge, e.g., `rushing to the hospital makes people worried' and `being in vacation makes people relaxed'; and metaphorical knowledge which includes idiomatic structures, e.g., `time flies' and `raining cats and dogs'. We believe that it is important to identify the most appropriate commonsense knowledge type required for specific tasks, in order to get better downstream performance. Once the knowledge type is identified, we can then select the appropriate knowledge base(s), the corresponding knowledge-extraction pipeline, and the suitable neural injection mechanisms.

In this work, we conduct a comparison study of different knowledge bases and knowledge-injection methods, on top of pre-trained neural language models; we evaluate model performance on a multiple-choice QA dataset, which explicitly requires commonsense reasoning. In particular, we used ConceptNet BIBREF6 and the recently-introduced ATOMIC BIBREF7 as our external knowledge resources, incorporating them in the neural computation pipeline using the Option Comparison Network (OCN) model mechanism BIBREF41. We evaluate our models on the CommonsenseQA BIBREF42 dataset; an example question from the CommonsenseQA task is shown in Table TABREF20. Our experimental results and analysis suggest that attention-based injection is preferable for knowledge-injection and that the degree of domain overlap, between knowledge-base and dataset, is vital to model success.

## Applications of Neuro-symbolism ::: Application II: Neural Question-Answering using Commonsense Knowledge Bases ::: Dataset

CommonsenseQA is a multiple-choice QA dataset that specifically measure commonsense reasoning BIBREF42. This dataset is constructed based on ConceptNet (see section SECREF23 for more information about this knowledge base). Specifically, a source concept is first extracted from ConceptNet, along with 3 target concepts that are connected to the source concept, i.e., a sub-graph. Crowd-workers are then asked to generate questions, using the source concept, such that only one of the target concepts can correctly answer the question. Additionally, 2 more “distractor” concepts are selected by crowd-workers, so that each question is associated with 5 answer-options. In total, the dataset contains 12,247 questions. For CommonsenseQA, we evaluate models on the development-set only, since test-set answers are not publicly available.

## Applications of Neuro-symbolism ::: Application II: Neural Question-Answering using Commonsense Knowledge Bases ::: Knowledge bases

The first knowledge-base we consider for our experiments is ConceptNet BIBREF6. ConceptNet contains over 21 million edges and 8 million nodes (1.5 million nodes in the partition for the English vocabulary), from which one may generate triples of the form $(C1, r, C2)$, wherein the natural-language concepts $C1$ and $C2$ are associated by commonsense relation $r$, e.g., (dinner, AtLocation, restaurant). Thanks to its coverage, ConceptNet is one of the most popular semantic networks for commonsense. ATOMIC BIBREF7 is a knowledge-base that focuses on procedural knowledge. Triples are of the form (Event, r, {Effect$|$Persona$|$Mental-state}), where head and tail are short sentences or verb phrases and $r$ represents an if-then relation type: (X compliments Y, xIntent, X wants to be nice). Since the CommonsenseQA dataset is open-domain and requires general commonsense, we think these knowledge-bases are most appropriate for our investigation.

## Applications of Neuro-symbolism ::: Application II: Neural Question-Answering using Commonsense Knowledge Bases ::: Model architecture

The model class we select is that of the Bidirectional Encoder Representations with Transformer (BERT) model BIBREF29, as it has been applied to numerous QA tasks and has achieved very promising performance, particularly on the CommonsenseQA dataset. When utilizing BERT on multiple-choice QA tasks, the standard approach is to concatenate the question with each answer-option, in order to generate a list of tokens which is then fed into BERT encoder; a linear layer is added on top, in order to predict the answer. One aspect of this strategy is that each answer-option is encoded independently, which limits the model's ability to find correlations between answer-options and with respect to the original question context. To address this issue, the Option Comparison Network (OCN) BIBREF41 was introduced to explicitly model the pairwise answer-option interactions, making OCN better-suited for multiple-choice QA task structures. The OCN model uses BERT as its base encoder: the question/option encoding is produced by BERT and further processed in a Option Comparison Cell, before being fed into linear layer. The Option Comparison Cell is illustrated in the bottom right of figure FIGREF21. We re-implemented OCN while keeping BERT as its upstream encoder (we refer an interested reader to BIBREF41, BIBREF43 for more details).

## Applications of Neuro-symbolism ::: Application II: Neural Question-Answering using Commonsense Knowledge Bases ::: Knowledge elicitation

ConceptNet. We identify ConceptNet relations that connect questions to the answer-options. The intuition is that these relation paths would provide explicit evidence that would help the model find the answer. Formally, given a question $Q$ and an answer-option $O$, we find all ConceptNet relations (C1, r, C2), such that $C1 \in Q$ and $C2 \in O$, or vice versa. This rule works well for single-word concepts. However, a large number of concepts in ConceptNet are actually phrases, where finding exactly matching phrases in $Q/O$ is more challenging. To fully utilize phrase-based relations, we relaxed the exact-match constraint to the following:

Here, the sequence $S$ represents $Q$ or $O$, depending on which sequence we try to match the concept $C$ to. Additionally, when the part-of-speech (POS) tag for a concept is available, we make sure it matches the POS tag of the corresponding word in $Q/O$. Table TABREF27 shows the extracted ConceptNet triples for the CommonsenseQA example in Table TABREF20. It is worth noting that we are able to extract the original ConceptNet sub-graph that was used to create the question, along with some extra triples. Although not perfect, the bold ConceptNet triple provides clues that could help the model resolve the correct answer.

ATOMIC. We observe that many questions in the CommonsenseQA task ask about which event is likely to occur, given a condition. Superficially, this particular question type seems well-suited for ATOMIC, whose focus is on procedural knowledge. Thus, we could frame our goal as evaluating whether ATOMIC can provide relevant knowledge to help answer these questions. However, one challenge of extracting knowledge from this resource is that heads and tails of knowledge triples in ATOMIC are short sentences or verb phrases, while rare words and person-references are reduced to blanks and PersonX/PersonY, respectively.

## Applications of Neuro-symbolism ::: Application II: Neural Question-Answering using Commonsense Knowledge Bases ::: Knowledge injection

Given previously-extracted knowledge triples, we need to integrate them with the OCN component of our model. Inspired by BIBREF33, we propose to use attention-based injection. For ConceptNet knowledge triples, we first convert concept-relation entities into tokens from our lexicon, in order to generate a pseudo-sentence. For example, “(book, AtLocation, library)” would be converted to “book at location library.” Next, we used the knowledge injection cell to fuse the commonsense knowledge into BERT's output, before feeding the fused output into the OCN cell. Specifically, in a knowledge-injection cell, a Bi-LSTM layer is used to encode these pseudo-sentences, before computing the attention with respect to BERT output, as illustrated in bottom left of figure FIGREF21.

## Applications of Neuro-symbolism ::: Application II: Neural Question-Answering using Commonsense Knowledge Bases ::: Knowledge pre-training

Pre-training large-capacity models (e.g., BERT, GPT BIBREF30, XLNet BIBREF31) on large corpora, then fine-tuning on more domain-specific information, has led to performance improvements on various tasks. Inspired by this, our goal in this section is to observe the effect of pre-training BERT on commonsense knowledge and refining the model on task-specific content from the CommonsenseQA dataset. Essentially, we would like to test if pre-training on our external knowledge resources can help the model acquire commonsense. For the ConceptNet pre-training procedure, pre-training BERT on pseudo-sentences formulated from ConceptNet knowledge triples does not provide much gain on performance. Instead, we trained BERT on the Open Mind Common Sense (OMCS) corpus BIBREF44, the originating corpus that was used to create ConceptNet. We extracted about 930K English sentences from OMCS and randomly masked out 15% of the tokens; we then fine-tuned BERT, using a masked language model objective, where the model's objective is to predict the masked tokens, as a probability distribution over the entire lexicon. Finally, we load this fine-tuned model into OCN framework proceed with the downstream CommonsenseQA task. As for pre-training on ATOMIC, we follow previous work's pre-processing steps to convert ATOMIC knowledge triples into sentences BIBREF45; we created special tokens for 9 types of relations as well as blanks. Next, we randomly masked out 15% of the tokens, only masking out tail-tokens; we used the same OMCS pre-training procedure.

## Applications of Neuro-symbolism ::: Application II: Neural Question-Answering using Commonsense Knowledge Bases ::: Results

For all of our experiments, we run 3 trials with different random seeds and we report average scores tables TABREF30 and TABREF32. Evaluated on CommonsenseQA, ConceptNet knowledge-injection provides a significant performance boost (+2.8%), compared to the OCN baseline, suggesting that explicit links from question to answer-options help the model find the correct answer. Pre-training on OMCS also provides a small performance boost to the OCN baseline. Since both ConceptNet knowledge-injection and OMCS pre-training are helpful, we combine both approaches with OCN and we are able to achieve further improvement (+4.9%). Finally, to our surprise, OCN pre-trained on ATOMIC yields a significantly lower performance.

## Applications of Neuro-symbolism ::: Application II: Neural Question-Answering using Commonsense Knowledge Bases ::: Error Analysis

To better understand when a model performs better or worse with knowledge-injection, we analyzed model predictions by question type. Since all questions in CommonsenseQA require commonsense reasoning, we classify questions based on the ConceptNet relation between the question concept and correct answer concept. The intuition is that the model needs to capture this relation in order to answer the question. The accuracies for each question type are shown in Table TABREF32. Note that the number of samples by question type is very imbalanced. Thus due to the limited space, we omitted the long tail of the distribution (about 7% of all samples). We can see that with ConceptNet relation-injection, all question types got performance boosts|for both the OCN model and OCN model that was pre-trained on OMCS|suggesting that external knowledge is indeed helpful for the task. In the case of OCN pre-trained on ATOMIC, although the overall performance is much lower than the OCN baseline, it is interesting to see that performance for the “Causes” type is not significantly affected. Moreover, performance for “CausesDesire” and “Desires” types actually got much better. As noted by BIBREF7, the “Causes” relation in ConceptNet is similar to “Effects” and “Reactions” in ATOMIC; and “CausesDesire” in ConceptNet is similar to “Wants” in ATOMIC. This result suggests that models with knowledge pre-training perform better on questions that fit the knowledge domain, but perform worse on others. In this case, pre-training on ATOMIC helps the model do better on questions that are similar to ATOMIC relations, even though overall performance is inferior. Finally, we noticed that questions of type “Antonym” appear to be the hardest ones. Many questions that fall into this category contain negations, and we hypothesize that the models still lack the ability to reason over negation sentences, suggesting another direction for future improvement.

## Applications of Neuro-symbolism ::: Application II: Neural Question-Answering using Commonsense Knowledge Bases ::: Discussion

Based on our experimental results and error analysis, we see that external knowledge is only helpful when there is alignment between questions and knowledge-base types. Thus, it is crucial to identify the question type and apply the best-suited knowledge. In terms of knowledge-injection methods, attention-based injection seems to be the better choice for pre-trained language models such as BERT. Even when alignment between knowledge-base and dataset is sub-optimal, the performance would not degrade. On the other hand, pre-training on knowledge-bases would shift the language model's weight distribution toward its own domain, greatly. If the task domain does not fit knowledge-base well, model performance is likely to drop. When the domain of the knowledge-base aligns with that of the dataset perfectly, both knowledge-injection methods bring performance boosts and a combination of them could bring further gain.

We have presented a survey on two popular knowledge bases (ConceptNet and ATOMIC) and recent knowledge-injection methods (attention and pre-training), on the CommonsenseQA task. We believe it is worth conducting a more comprehensive study of datasets and knowledge-bases and putting more effort towards defining an auxiliary neural learning objectives, in a multi-task learning framework, that classifies the type of knowledge required, based on data characteristics. In parallel, we are also interested in building a global commonsense knowledge base by aggregating ConceptNet, ATOMIC, and potentially other resources like FrameNet BIBREF46 and MetaNet BIBREF47, on the basis of a shared-reference ontology (following the approaches described in BIBREF48 and BIBREF49): the goal would be to assess whether injecting knowledge structures from a semantically-cohesive lexical knowledge base of commonsense would guarantee stable model accuracy across datasets.

## Conclusion

We illustrated two projects on computational context understanding through neuro-symbolism. The first project (section SECREF3) concerned the use of knowledge graphs to learning an embedding space for characterising visual scenes, in the context of autonomous driving. The second application (section SECREF17) focused on the extraction and integration of knowledge, encoded in commonsense knowledge bases, for guiding the learning process of neural language models in question-answering tasks. Although diverse in scope and breadth, both projects adopt a hybrid approach to building AI systems, where deep neural networks are enhanced with knowledge graphs. For instance, in the first project we demonstrated that scenes that are visually different can be discovered as sharing similar semantic characteristics by using knowledge graph embeddings; in the second project we showed that a language model is more accurate when it includes specialized modules to evaluate questions and candidate answers on the basis of a common knowledge graph. In both cases, explainability emerges as a property of the mechanisms that we implemented, through this combination of data-driven algorithms with the relevant knowledge resources.

We began the chapter by alluding to the way in which humans leverage a complex array of cognitive processes, in order to understand the environment; we further stated that one of the greatest challenges in AI research is learning how to endow machines with similar sense-making capabilities. In these final remarks, it is important to emphasize again (see footnote #3) that the capability we describe here need only follow from satisfying the functional requirements of context understanding, rather than concerning ourselves with how those requirements are specifically implemented in humans versus machines. In other words, our hybrid AI approach stems from the complementary nature of perception and knowledge, but does not commit to the notion of replicating human cognition in the machine: as knowledge graphs can only capture a stripped-down representation of what we know, deep neural networks can only approximate how we perceive the world and learn from it. Certainly, human knowledge (encoded in machine-consumable format) abounds in the digital world, and our work shows that these knowledge bases can be used to instruct ML models and, ultimately, enhance AI systems.
